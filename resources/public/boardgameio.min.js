!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports):"function"==typeof define&&define.amd?define(["exports"],t):t((e=e||self).BoardgameIO={})}(this,(function(e){"use strict";let t=(e=21)=>{let t="",n=crypto.getRandomValues(new Uint8Array(e));for(;e--;){let r=63&n[e];t+=r<36?r.toString(36):r<62?(r-26).toString(36).toUpperCase():r<63?"_":"-"}return t};function n(){}const r=e=>e;function a(e,t){for(const n in t)e[n]=t[n];return e}function o(e){return e()}function s(){return Object.create(null)}function i(e){e.forEach(o)}function l(e){return"function"==typeof e}function c(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function u(e,...t){if(null==e)return n;const r=e.subscribe(...t);return r.unsubscribe?()=>r.unsubscribe():r}function d(e,t,n){e.$$.on_destroy.push(u(t,n))}function p(e,t,n,r){return e[1]&&r?a(n.ctx.slice(),e[1](r(t))):n.ctx}function f(e,t,n,r,a,o,s){const i=function(e,t,n,r){if(e[2]&&r){const a=e[2](r(n));if(void 0===t.dirty)return a;if("object"==typeof a){const e=[],n=Math.max(t.dirty.length,a.length);for(let r=0;r<n;r+=1)e[r]=t.dirty[r]|a[r];return e}return t.dirty|a}return t.dirty}(t,r,a,o);if(i){const a=p(t,n,r,s);e.p(a,i)}}function v(e){const t={};for(const n in e)"$"!==n[0]&&(t[n]=e[n]);return t}function m(e){return null==e?"":e}const y="undefined"!=typeof window;let h=y?()=>window.performance.now():()=>Date.now(),g=y?e=>requestAnimationFrame(e):n;const b=new Set;function $(e){b.forEach(t=>{t.c(e)||(b.delete(t),t.f())}),0!==b.size&&g($)}function x(e,t){e.appendChild(t)}function w(e,t,n){e.insertBefore(t,n||null)}function P(e){e.parentNode.removeChild(e)}function k(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function E(e){return document.createElement(e)}function O(e){return document.createElementNS("http://www.w3.org/2000/svg",e)}function I(e){return document.createTextNode(e)}function j(){return I(" ")}function A(){return I("")}function _(e,t,n,r){return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n,r)}function D(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function S(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function M(e,t){e.value=null==t?"":t}function C(e,t){for(let n=0;n<e.options.length;n+=1){const r=e.options[n];if(r.__value===t)return void(r.selected=!0)}}function N(e){const t=e.querySelector(":checked")||e.options[0];return t&&t.__value}function T(e,t,n){e.classList[n?"add":"remove"](t)}function z(e,t){const n=document.createEvent("CustomEvent");return n.initCustomEvent(e,!1,!1,t),n}const G=new Set;let q,B=0;function L(e,t,n,r,a,o,s,i=0){const l=16.666/r;let c="{\n";for(let e=0;e<=1;e+=l){const r=t+(n-t)*o(e);c+=100*e+`%{${s(r,1-r)}}\n`}const u=c+`100% {${s(n,1-n)}}\n}`,d=`__svelte_${function(e){let t=5381,n=e.length;for(;n--;)t=(t<<5)-t^e.charCodeAt(n);return t>>>0}(u)}_${i}`,p=e.ownerDocument;G.add(p);const f=p.__svelte_stylesheet||(p.__svelte_stylesheet=p.head.appendChild(E("style")).sheet),v=p.__svelte_rules||(p.__svelte_rules={});v[d]||(v[d]=!0,f.insertRule(`@keyframes ${d} ${u}`,f.cssRules.length));const m=e.style.animation||"";return e.style.animation=`${m?`${m}, `:""}${d} ${r}ms linear ${a}ms 1 both`,B+=1,d}function R(e,t){const n=(e.style.animation||"").split(", "),r=n.filter(t?e=>e.indexOf(t)<0:e=>-1===e.indexOf("__svelte")),a=n.length-r.length;a&&(e.style.animation=r.join(", "),B-=a,B||g(()=>{B||(G.forEach(e=>{const t=e.__svelte_stylesheet;let n=t.cssRules.length;for(;n--;)t.deleteRule(n);e.__svelte_rules={}}),G.clear())}))}function U(e){q=e}function V(){if(!q)throw new Error("Function called outside component initialization");return q}function J(e){V().$$.on_destroy.push(e)}function K(){const e=V();return(t,n)=>{const r=e.$$.callbacks[t];if(r){const a=z(t,n);r.slice().forEach(t=>{t.call(e,a)})}}}function F(e,t){V().$$.context.set(e,t)}function W(e){return V().$$.context.get(e)}function H(e,t){const n=e.$$.callbacks[t.type];n&&n.slice().forEach(e=>e(t))}const Y=[],X=[],Z=[],Q=[],ee=Promise.resolve();let te=!1;function ne(e){Z.push(e)}let re=!1;const ae=new Set;function oe(){if(!re){re=!0;do{for(let e=0;e<Y.length;e+=1){const t=Y[e];U(t),se(t.$$)}for(Y.length=0;X.length;)X.pop()();for(let e=0;e<Z.length;e+=1){const t=Z[e];ae.has(t)||(ae.add(t),t())}Z.length=0}while(Y.length);for(;Q.length;)Q.pop()();te=!1,re=!1,ae.clear()}}function se(e){if(null!==e.fragment){e.update(),i(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(ne)}}let ie;function le(e,t,n){e.dispatchEvent(z(`${t?"intro":"outro"}${n}`))}const ce=new Set;let ue;function de(){ue={r:0,c:[],p:ue}}function pe(){ue.r||i(ue.c),ue=ue.p}function fe(e,t){e&&e.i&&(ce.delete(e),e.i(t))}function ve(e,t,n,r){if(e&&e.o){if(ce.has(e))return;ce.add(e),ue.c.push(()=>{ce.delete(e),r&&(n&&e.d(1),r())}),e.o(t)}}const me={duration:0};function ye(e,t,a,o){let s=t(e,a),c=o?0:1,u=null,d=null,p=null;function f(){p&&R(e,p)}function v(e,t){const n=e.b-c;return t*=Math.abs(n),{a:c,b:e.b,d:n,duration:t,start:e.start,end:e.start+t,group:e.group}}function m(t){const{delay:a=0,duration:o=300,easing:l=r,tick:m=n,css:y}=s||me,x={start:h()+a,b:t};t||(x.group=ue,ue.r+=1),u?d=x:(y&&(f(),p=L(e,c,t,o,a,l,y)),t&&m(0,1),u=v(x,o),ne(()=>le(e,t,"start")),function(e){let t;0===b.size&&g($),new Promise(n=>{b.add(t={c:e,f:n})})}(t=>{if(d&&t>d.start&&(u=v(d,o),d=null,le(e,u.b,"start"),y&&(f(),p=L(e,c,u.b,u.duration,0,l,s.css))),u)if(t>=u.end)m(c=u.b,1-c),le(e,u.b,"end"),d||(u.b?f():--u.group.r||i(u.group.c)),u=null;else if(t>=u.start){const e=t-u.start;c=u.a+u.d*l(e/u.duration),m(c,1-c)}return!(!u&&!d)}))}return{run(e){l(s)?(ie||(ie=Promise.resolve(),ie.then(()=>{ie=null})),ie).then(()=>{s=s(),m(e)}):m(e)},end(){f(),u=d=null}}}const he="undefined"!=typeof window?window:"undefined"!=typeof globalThis?globalThis:global;function ge(e){e&&e.c()}function be(e,t,n){const{fragment:r,on_mount:a,on_destroy:s,after_update:c}=e.$$;r&&r.m(t,n),ne(()=>{const t=a.map(o).filter(l);s?s.push(...t):i(t),e.$$.on_mount=[]}),c.forEach(ne)}function $e(e,t){const n=e.$$;null!==n.fragment&&(i(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function xe(e,t){-1===e.$$.dirty[0]&&(Y.push(e),te||(te=!0,ee.then(oe)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function we(e,t,r,a,o,l,c=[-1]){const u=q;U(e);const d=t.props||{},p=e.$$={fragment:null,ctx:null,props:l,update:n,not_equal:o,bound:s(),on_mount:[],on_destroy:[],before_update:[],after_update:[],context:new Map(u?u.$$.context:[]),callbacks:s(),dirty:c};let f=!1;if(p.ctx=r?r(e,d,(t,n,...r)=>{const a=r.length?r[0]:n;return p.ctx&&o(p.ctx[t],p.ctx[t]=a)&&(p.bound[t]&&p.bound[t](a),f&&xe(e,t)),n}):[],p.update(),f=!0,i(p.before_update),p.fragment=!!a&&a(p.ctx),t.target){if(t.hydrate){const e=function(e){return Array.from(e.childNodes)}(t.target);p.fragment&&p.fragment.l(e),e.forEach(P)}else p.fragment&&p.fragment.c();t.intro&&fe(e.$$.fragment),be(e,t.target,t.anchor),oe()}U(u)}class Pe{$destroy(){$e(this,1),this.$destroy=n}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(){}}var ke=function(e){var t,n=e.Symbol;return"function"==typeof n?n.observable?t=n.observable:(t=n("observable"),n.observable=t):t="@@observable",t}("undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof module?module:Function("return this")()),Ee=function(){return Math.random().toString(36).substring(7).split("").join(".")},Oe={INIT:"@@redux/INIT"+Ee(),REPLACE:"@@redux/REPLACE"+Ee(),PROBE_UNKNOWN_ACTION:function(){return"@@redux/PROBE_UNKNOWN_ACTION"+Ee()}};function Ie(e){if("object"!=typeof e||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}function je(e,t,n){var r;if("function"==typeof t&&"function"==typeof n||"function"==typeof n&&"function"==typeof arguments[3])throw new Error("It looks like you are passing several store enhancers to createStore(). This is not supported. Instead, compose them together to a single function.");if("function"==typeof t&&void 0===n&&(n=t,t=void 0),void 0!==n){if("function"!=typeof n)throw new Error("Expected the enhancer to be a function.");return n(je)(e,t)}if("function"!=typeof e)throw new Error("Expected the reducer to be a function.");var a=e,o=t,s=[],i=s,l=!1;function c(){i===s&&(i=s.slice())}function u(){if(l)throw new Error("You may not call store.getState() while the reducer is executing. The reducer has already received the state as an argument. Pass it down from the top reducer instead of reading it from the store.");return o}function d(e){if("function"!=typeof e)throw new Error("Expected the listener to be a function.");if(l)throw new Error("You may not call store.subscribe() while the reducer is executing. If you would like to be notified after the store has been updated, subscribe from a component and invoke store.getState() in the callback to access the latest state. See https://redux.js.org/api-reference/store#subscribe(listener) for more details.");var t=!0;return c(),i.push(e),function(){if(t){if(l)throw new Error("You may not unsubscribe from a store listener while the reducer is executing. See https://redux.js.org/api-reference/store#subscribe(listener) for more details.");t=!1,c();var n=i.indexOf(e);i.splice(n,1)}}}function p(e){if(!Ie(e))throw new Error("Actions must be plain objects. Use custom middleware for async actions.");if(void 0===e.type)throw new Error('Actions may not have an undefined "type" property. Have you misspelled a constant?');if(l)throw new Error("Reducers may not dispatch actions.");try{l=!0,o=a(o,e)}finally{l=!1}for(var t=s=i,n=0;n<t.length;n++){(0,t[n])()}return e}function f(e){if("function"!=typeof e)throw new Error("Expected the nextReducer to be a function.");a=e,p({type:Oe.REPLACE})}function v(){var e,t=d;return(e={subscribe:function(e){if("object"!=typeof e||null===e)throw new TypeError("Expected the observer to be an object.");function n(){e.next&&e.next(u())}return n(),{unsubscribe:t(n)}}})[ke]=function(){return this},e}return p({type:Oe.INIT}),(r={dispatch:p,subscribe:d,getState:u,replaceReducer:f})[ke]=v,r}function Ae(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _e(e,t){var n=Object.keys(e);return Object.getOwnPropertySymbols&&n.push.apply(n,Object.getOwnPropertySymbols(e)),t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n}function De(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?_e(n,!0).forEach((function(t){Ae(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):_e(n).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Se(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return 0===t.length?function(e){return e}:1===t.length?t[0]:t.reduce((function(e,t){return function(){return e(t.apply(void 0,arguments))}}))}const Me=(e,t,n,r)=>({type:"MAKE_MOVE",payload:{type:e,args:t,playerID:n,credentials:r}}),Ce=(e,t,n,r)=>({type:"GAME_EVENT",payload:{type:e,args:t,playerID:n,credentials:r}}),Ne=(e,t,n,r)=>({type:"GAME_EVENT",payload:{type:e,args:t,playerID:n,credentials:r},automatic:!0}),Te=e=>({type:"SYNC",state:e.state,log:e.log,initialState:e.initialState,clientOnly:!0}),ze=e=>({type:"RESET",state:e,clientOnly:!0}),Ge=(e,t)=>({type:"UNDO",payload:{type:null,args:null,playerID:e,credentials:t}}),qe=(e,t)=>({type:"REDO",payload:{type:null,args:null,playerID:e,credentials:t}}),Be=()=>({type:"STRIP_TRANSIENTS"});var Le=Object.freeze({makeMove:Me,gameEvent:Ce,automaticGameEvent:Ne,sync:Te,patch:(e,t,n,r)=>({type:"PATCH",prevStateID:e,stateID:t,patch:n,deltalog:r,clientOnly:!0}),update:(e,t)=>({type:"UPDATE",state:e,deltalog:t,clientOnly:!0}),reset:ze,undo:Ge,redo:qe,plugin:(e,t,n,r)=>({type:"PLUGIN",payload:{type:e,args:t,playerID:n,credentials:r}}),stripTransients:Be});function Re(e){for(var t=arguments.length,n=Array(t>1?t-1:0),r=1;r<t;r++)n[r-1]=arguments[r];throw Error("[Immer] minified error nr: "+e+(n.length?" "+n.map((function(e){return"'"+e+"'"})).join(","):"")+". Find the full error at: https://bit.ly/3cXEKWf")}function Ue(e){return!!e&&!!e[jt]}function Ve(e){return!!e&&(function(e){if(!e||"object"!=typeof e)return!1;var t=Object.getPrototypeOf(e);return!t||t===Object.prototype}(e)||Array.isArray(e)||!!e[It]||!!e.constructor[It]||He(e)||Ye(e))}function Je(e,t,n){void 0===n&&(n=!1),0===Ke(e)?(n?Object.keys:At)(e).forEach((function(r){n&&"symbol"==typeof r||t(r,e[r],e)})):e.forEach((function(n,r){return t(r,n,e)}))}function Ke(e){var t=e[jt];return t?t.i>3?t.i-4:t.i:Array.isArray(e)?1:He(e)?2:Ye(e)?3:0}function Fe(e,t){return 2===Ke(e)?e.has(t):Object.prototype.hasOwnProperty.call(e,t)}function We(e,t,n){var r=Ke(e);2===r?e.set(t,n):3===r?(e.delete(t),e.add(n)):e[t]=n}function He(e){return Pt&&e instanceof Map}function Ye(e){return kt&&e instanceof Set}function Xe(e){return e.o||e.t}function Ze(e){if(Array.isArray(e))return Array.prototype.slice.call(e);var t=_t(e);delete t[jt];for(var n=At(t),r=0;r<n.length;r++){var a=n[r],o=t[a];!1===o.writable&&(o.writable=!0,o.configurable=!0),(o.get||o.set)&&(t[a]={configurable:!0,writable:!0,enumerable:o.enumerable,value:e[a]})}return Object.create(Object.getPrototypeOf(e),t)}function Qe(e,t){return void 0===t&&(t=!1),tt(e)||Ue(e)||!Ve(e)||(Ke(e)>1&&(e.set=e.add=e.clear=e.delete=et),Object.freeze(e),t&&Je(e,(function(e,t){return Qe(t,!0)}),!0)),e}function et(){Re(2)}function tt(e){return null==e||"object"!=typeof e||Object.isFrozen(e)}function nt(e){var t=Dt[e];return t||Re(18,e),t}function rt(){return xt}function at(e,t){t&&(nt("Patches"),e.u=[],e.s=[],e.v=t)}function ot(e){st(e),e.p.forEach(lt),e.p=null}function st(e){e===xt&&(xt=e.l)}function it(e){return xt={p:[],l:xt,h:e,m:!0,_:0}}function lt(e){var t=e[jt];0===t.i||1===t.i?t.j():t.g=!0}function ct(e,t){t._=t.p.length;var n=t.p[0],r=void 0!==e&&e!==n;return t.h.O||nt("ES5").S(t,e,r),r?(n[jt].P&&(ot(t),Re(4)),Ve(e)&&(e=ut(t,e),t.l||pt(t,e)),t.u&&nt("Patches").M(n[jt],e,t.u,t.s)):e=ut(t,n,[]),ot(t),t.u&&t.v(t.u,t.s),e!==Ot?e:void 0}function ut(e,t,n){if(tt(t))return t;var r=t[jt];if(!r)return Je(t,(function(a,o){return dt(e,r,t,a,o,n)}),!0),t;if(r.A!==e)return t;if(!r.P)return pt(e,r.t,!0),r.t;if(!r.I){r.I=!0,r.A._--;var a=4===r.i||5===r.i?r.o=Ze(r.k):r.o;Je(3===r.i?new Set(a):a,(function(t,o){return dt(e,r,a,t,o,n)})),pt(e,a,!1),n&&e.u&&nt("Patches").R(r,n,e.u,e.s)}return r.o}function dt(e,t,n,r,a,o){if(Ue(a)){var s=ut(e,a,o&&t&&3!==t.i&&!Fe(t.D,r)?o.concat(r):void 0);if(We(n,r,s),!Ue(s))return;e.m=!1}if(Ve(a)&&!tt(a)){if(!e.h.N&&e._<1)return;ut(e,a),t&&t.A.l||pt(e,a)}}function pt(e,t,n){void 0===n&&(n=!1),e.h.N&&e.m&&Qe(t,n)}function ft(e,t){var n=e[jt];return(n?Xe(n):e)[t]}function vt(e,t){if(t in e)for(var n=Object.getPrototypeOf(e);n;){var r=Object.getOwnPropertyDescriptor(n,t);if(r)return r;n=Object.getPrototypeOf(n)}}function mt(e){e.P||(e.P=!0,e.l&&mt(e.l))}function yt(e){e.o||(e.o=Ze(e.t))}function ht(e,t,n){var r=He(t)?nt("MapSet").T(t,n):Ye(t)?nt("MapSet").F(t,n):e.O?function(e,t){var n=Array.isArray(e),r={i:n?1:0,A:t?t.A:rt(),P:!1,I:!1,D:{},l:t,t:e,k:null,o:null,j:null,C:!1},a=r,o=St;n&&(a=[r],o=Mt);var s=Proxy.revocable(a,o),i=s.revoke,l=s.proxy;return r.k=l,r.j=i,l}(t,n):nt("ES5").J(t,n);return(n?n.A:rt()).p.push(r),r}function gt(e){return Ue(e)||Re(22,e),function e(t){if(!Ve(t))return t;var n,r=t[jt],a=Ke(t);if(r){if(!r.P&&(r.i<4||!nt("ES5").K(r)))return r.t;r.I=!0,n=bt(t,a),r.I=!1}else n=bt(t,a);return Je(n,(function(t,a){r&&function(e,t){return 2===Ke(e)?e.get(t):e[t]}(r.t,t)===a||We(n,t,e(a))})),3===a?new Set(n):n}(e)}function bt(e,t){switch(t){case 2:return new Map(e);case 3:return Array.from(e)}return Ze(e)}var $t,xt,wt="undefined"!=typeof Symbol&&"symbol"==typeof Symbol("x"),Pt="undefined"!=typeof Map,kt="undefined"!=typeof Set,Et="undefined"!=typeof Proxy&&void 0!==Proxy.revocable&&"undefined"!=typeof Reflect,Ot=wt?Symbol.for("immer-nothing"):(($t={})["immer-nothing"]=!0,$t),It=wt?Symbol.for("immer-draftable"):"__$immer_draftable",jt=wt?Symbol.for("immer-state"):"__$immer_state",At="undefined"!=typeof Reflect&&Reflect.ownKeys?Reflect.ownKeys:void 0!==Object.getOwnPropertySymbols?function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Object.getOwnPropertyNames,_t=Object.getOwnPropertyDescriptors||function(e){var t={};return At(e).forEach((function(n){t[n]=Object.getOwnPropertyDescriptor(e,n)})),t},Dt={},St={get:function(e,t){if(t===jt)return e;var n=Xe(e);if(!Fe(n,t))return function(e,t,n){var r,a=vt(t,n);return a?"value"in a?a.value:null===(r=a.get)||void 0===r?void 0:r.call(e.k):void 0}(e,n,t);var r=n[t];return e.I||!Ve(r)?r:r===ft(e.t,t)?(yt(e),e.o[t]=ht(e.A.h,r,e)):r},has:function(e,t){return t in Xe(e)},ownKeys:function(e){return Reflect.ownKeys(Xe(e))},set:function(e,t,n){var r=vt(Xe(e),t);if(null==r?void 0:r.set)return r.set.call(e.k,n),!0;if(!e.P){var a=ft(Xe(e),t),o=null==a?void 0:a[jt];if(o&&o.t===n)return e.o[t]=n,e.D[t]=!1,!0;if(function(e,t){return e===t?0!==e||1/e==1/t:e!=e&&t!=t}(n,a)&&(void 0!==n||Fe(e.t,t)))return!0;yt(e),mt(e)}return e.o[t]=n,e.D[t]=!0,!0},deleteProperty:function(e,t){return void 0!==ft(e.t,t)||t in e.t?(e.D[t]=!1,yt(e),mt(e)):delete e.D[t],e.o&&delete e.o[t],!0},getOwnPropertyDescriptor:function(e,t){var n=Xe(e),r=Reflect.getOwnPropertyDescriptor(n,t);return r?{writable:!0,configurable:1!==e.i||"length"!==t,enumerable:r.enumerable,value:n[t]}:r},defineProperty:function(){Re(11)},getPrototypeOf:function(e){return Object.getPrototypeOf(e.t)},setPrototypeOf:function(){Re(12)}},Mt={};Je(St,(function(e,t){Mt[e]=function(){return arguments[0]=arguments[0][0],t.apply(this,arguments)}})),Mt.deleteProperty=function(e,t){return St.deleteProperty.call(this,e[0],t)},Mt.set=function(e,t,n){return St.set.call(this,e[0],t,n,e[0])};var Ct=new(function(){function e(e){this.O=Et,this.N=!0,"boolean"==typeof(null==e?void 0:e.useProxies)&&this.setUseProxies(e.useProxies),"boolean"==typeof(null==e?void 0:e.autoFreeze)&&this.setAutoFreeze(e.autoFreeze),this.produce=this.produce.bind(this),this.produceWithPatches=this.produceWithPatches.bind(this)}var t=e.prototype;return t.produce=function(e,t,n){if("function"==typeof e&&"function"!=typeof t){var r=t;t=e;var a=this;return function(e){var n=this;void 0===e&&(e=r);for(var o=arguments.length,s=Array(o>1?o-1:0),i=1;i<o;i++)s[i-1]=arguments[i];return a.produce(e,(function(e){var r;return(r=t).call.apply(r,[n,e].concat(s))}))}}var o;if("function"!=typeof t&&Re(6),void 0!==n&&"function"!=typeof n&&Re(7),Ve(e)){var s=it(this),i=ht(this,e,void 0),l=!0;try{o=t(i),l=!1}finally{l?ot(s):st(s)}return"undefined"!=typeof Promise&&o instanceof Promise?o.then((function(e){return at(s,n),ct(e,s)}),(function(e){throw ot(s),e})):(at(s,n),ct(o,s))}if(!e||"object"!=typeof e){if((o=t(e))===Ot)return;return void 0===o&&(o=e),this.N&&Qe(o,!0),o}Re(21,e)},t.produceWithPatches=function(e,t){var n,r,a=this;return"function"==typeof e?function(t){for(var n=arguments.length,r=Array(n>1?n-1:0),o=1;o<n;o++)r[o-1]=arguments[o];return a.produceWithPatches(t,(function(t){return e.apply(void 0,[t].concat(r))}))}:[this.produce(e,t,(function(e,t){n=e,r=t})),n,r]},t.createDraft=function(e){Ve(e)||Re(8),Ue(e)&&(e=gt(e));var t=it(this),n=ht(this,e,void 0);return n[jt].C=!0,st(t),n},t.finishDraft=function(e,t){var n=(e&&e[jt]).A;return at(n,t),ct(void 0,n)},t.setAutoFreeze=function(e){this.N=e},t.setUseProxies=function(e){e&&!Et&&Re(20),this.O=e},t.applyPatches=function(e,t){var n;for(n=t.length-1;n>=0;n--){var r=t[n];if(0===r.path.length&&"replace"===r.op){e=r.value;break}}var a=nt("Patches").$;return Ue(e)?a(e,t):this.produce(e,(function(e){return a(e,t.slice(n+1))}))},e}()),Nt=Ct.produce;Ct.produceWithPatches.bind(Ct),Ct.setAutoFreeze.bind(Ct),Ct.setUseProxies.bind(Ct),Ct.applyPatches.bind(Ct),Ct.createDraft.bind(Ct),Ct.finishDraft.bind(Ct);const Tt={name:"plugin-immer",fnWrap:e=>(t,n,...r)=>{let a=!1;const o=Nt(t,t=>{const o=e(t,n,...r);if("INVALID_MOVE"!==o)return o;a=!0});return a?"INVALID_MOVE":o}};class zt{constructor(e){const t=function(){let e=4022871197;return function(t){const n=t.toString();for(let t=0;t<n.length;t++){e+=n.charCodeAt(t);let r=.02519603282416938*e;e=r>>>0,r-=e,r*=e,e=r>>>0,r-=e,e+=4294967296*r}return 2.3283064365386963e-10*(e>>>0)}}();this.c=1,this.s0=t(" "),this.s1=t(" "),this.s2=t(" "),this.s0-=t(e),this.s0<0&&(this.s0+=1),this.s1-=t(e),this.s1<0&&(this.s1+=1),this.s2-=t(e),this.s2<0&&(this.s2+=1)}next(){const e=2091639*this.s0+2.3283064365386963e-10*this.c;return this.s0=this.s1,this.s1=this.s2,this.s2=e-(this.c=Math.trunc(e))}}function Gt(e,t){return t.c=e.c,t.s0=e.s0,t.s1=e.s1,t.s2=e.s2,t}function qt(e,t){const n=new zt(e),r=n.next.bind(n);return t&&Gt(t,n),r.state=()=>Gt(n,{}),r}class Bt{constructor(e){this.state=e||{seed:"0"},this.used=!1}static seed(){return Date.now().toString(36).slice(-10)}isUsed(){return this.used}getState(){return this.state}_random(){this.used=!0;const e=this.state,t=qt(e.prngstate?"":e.seed,e.prngstate),n=t();return this.state={...e,prngstate:t.state()},n}api(){const e=this._random.bind(this),t={D4:4,D6:6,D8:8,D10:10,D12:12,D20:20},n={};for(const r in t){const a=t[r];n[r]=t=>void 0===t?Math.floor(e()*a)+1:[...new Array(t).keys()].map(()=>Math.floor(e()*a)+1)}return{...n,Die:function(t=6,n){return void 0===n?Math.floor(e()*t)+1:[...new Array(n).keys()].map(()=>Math.floor(e()*t)+1)},Number:()=>e(),Shuffle:t=>{const n=t.slice(0);let r=t.length,a=0;const o=new Array(r);for(;r;){const t=Math.trunc(r*e());o[a++]=n[t],n[t]=n[--r]}return o},_obj:this}}}const Lt={name:"random",noClient:({api:e})=>e._obj.isUsed(),flush:({api:e})=>e._obj.getState(),api:({data:e})=>new Bt(e).api(),setup:({game:e})=>{let{seed:t}=e;return void 0===t&&(t=Bt.seed()),{seed:t}},playerView:()=>{}};class Rt{constructor(e,t){this.flow=e,this.playerID=t,this.dispatch=[]}api(e){const t={_obj:this},{phase:n,turn:r}=e;for(const e of this.flow.eventNames)t[e]=(...t)=>{this.dispatch.push({key:e,args:t,phase:n,turn:r})};return t}isUsed(){return this.dispatch.length>0}update(e){for(let t=0;t<this.dispatch.length;t++){const n=this.dispatch[t];if("endTurn"===n.key&&n.turn!==e.ctx.turn)continue;if(("endPhase"===n.key||"setPhase"===n.key)&&n.phase!==e.ctx.phase)continue;const r=Ne(n.key,n.args,this.playerID);e={...e,...this.flow.processEvent(e,r)}}return e}}const Ut={name:"events",noClient:({api:e})=>e._obj.isUsed(),dangerouslyFlushRawState:({state:e,api:t})=>t._obj.update(e),api:({game:e,playerID:t,ctx:n})=>new Rt(e.flow,t).api(n)};var Vt,Jt,Kt=Function.prototype,Ft=Object.prototype,Wt=Kt.toString,Ht=Ft.hasOwnProperty,Yt=Wt.call(Object),Xt=Ft.toString,Zt=(Vt=Object.getPrototypeOf,Jt=Object,function(e){return Vt(Jt(e))});var Qt=function(e){if(!function(e){return!!e&&"object"==typeof e}(e)||"[object Object]"!=Xt.call(e)||function(e){var t=!1;if(null!=e&&"function"!=typeof e.toString)try{t=!!(e+"")}catch(e){}return t}(e))return!1;var t=Zt(e);if(null===t)return!0;var n=Ht.call(t,"constructor")&&t.constructor;return"function"==typeof n&&n instanceof n&&Wt.call(n)==Yt};const en=[Tt,Lt,{name:"log",flush:()=>({}),api:({data:e})=>({setMetadata:t=>{e.metadata=t}}),setup:()=>({})},{name:"plugin-serializable",fnWrap:e=>(t,n,...r)=>{const a=e(t,n,...r);if(!function e(t){if(null==t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t)return!0;if(!Qt(t)&&!Array.isArray(t))return!1;for(const n in t)if(!e(t[n]))return!1;return!0}(a))throw new Error("Move state is not JSON-serialiazable.\nSee https://boardgame.io/documentation/#/?id=state for more information.");return a}}],tn=[...en,Ut],nn=e=>{const t={...e.ctx},n=e.plugins||{};return Object.entries(n).forEach(([e,{api:n}])=>{t[e]=n}),t},rn=(e,t)=>[...tn,...t].filter(e=>void 0!==e.fnWrap).reduce((e,{fnWrap:t})=>t(e),e),an=(e,t)=>([...tn,...t.game.plugins].filter(e=>void 0!==e.api).forEach(n=>{const r=n.name,a=e.plugins[r]||{data:{}},o=n.api({G:e.G,ctx:e.ctx,data:a.data,game:t.game,playerID:t.playerID});e={...e,plugins:{...e.plugins,[r]:{...a,api:o}}}}),e),on=(e,t)=>([...en,...t.game.plugins,Ut].reverse().forEach(n=>{const r=n.name,a=e.plugins[r]||{data:{}};if(n.flush){const r=n.flush({G:e.G,ctx:e.ctx,game:t.game,api:a.api,data:a.data});e={...e,plugins:{...e.plugins,[n.name]:{data:r}}}}else if(n.dangerouslyFlushRawState){const o=(e=n.dangerouslyFlushRawState({state:e,game:t.game,api:a.api,data:a.data})).plugins[r].data;e={...e,plugins:{...e.plugins,[n.name]:{data:o}}}}}),e),sn=({G:e,ctx:t,plugins:n={}},{game:r,playerID:a})=>([...tn,...r.plugins].forEach(({name:o,playerView:s})=>{if(!s)return;const{data:i}=n[o]||{data:{}},l=s({G:e,ctx:t,game:r,data:i,playerID:a});n={...n,[o]:{data:l}}}),n);function ln(e){((...e)=>{console.log(...e)})(`INFO: ${e}`)}function cn(e){((...e)=>{console.error(...e)})("ERROR:",e)}function un(e,t,n){return{...e,ctx:dn(e.ctx,n)}}function dn(e,t){let{_prevActivePlayers:n}=e,r={},a=null,o={};if(Array.isArray(t)){const e={};t.forEach(t=>e[t]=mn.NULL),r=e}else{if(t.next&&(a=t.next),n=t.revert?n.concat({activePlayers:e.activePlayers,_activePlayersMoveLimit:e._activePlayersMoveLimit,_activePlayersNumMoves:e._activePlayersNumMoves}):[],void 0!==t.currentPlayer&&pn(r,o,e.currentPlayer,t.currentPlayer),void 0!==t.others)for(let n=0;n<e.playOrder.length;n++){const a=e.playOrder[n];a!==e.currentPlayer&&pn(r,o,a,t.others)}if(void 0!==t.all)for(let n=0;n<e.playOrder.length;n++){pn(r,o,e.playOrder[n],t.all)}if(t.value)for(const e in t.value)pn(r,o,e,t.value[e]);if(t.moveLimit)for(const e in r)void 0===o[e]&&(o[e]=t.moveLimit)}0==Object.keys(r).length&&(r=null),0==Object.keys(o).length&&(o=null);const s={};for(const e in r)s[e]=0;return{...e,activePlayers:r,_activePlayersMoveLimit:o,_activePlayersNumMoves:s,_prevActivePlayers:n,_nextActivePlayers:a}}function pn(e,t,n,r){"object"==typeof r&&r!==mn.NULL||(r={stage:r}),void 0!==r.stage&&(e[n]=r.stage,r.moveLimit&&(t[n]=r.moveLimit))}function fn(e,t){return e[t]+""}const vn={first:(e,t)=>0===t.turn?t.playOrderPos:(t.playOrderPos+1)%t.playOrder.length,next:(e,t)=>(t.playOrderPos+1)%t.playOrder.length},mn={NULL:null};function yn({moves:e,phases:t,endIf:n,onEnd:r,turn:a,events:o,plugins:s}){void 0===e&&(e={}),void 0===o&&(o={}),void 0===s&&(s=[]),void 0===t&&(t={}),n||(n=()=>{}),r||(r=e=>e),a||(a={});const i={...t};""in i&&cn("cannot specify phase with empty name"),i[""]={};const l={},c=new Set;let u=null;Object.keys(e).forEach(e=>c.add(e));const d=e=>{const t=rn(e,s);return e=>{const n=nn(e);return t(e.G,n)}},p=e=>t=>{const n=nn(t);return e(t.G,n)},f={onEnd:d(r),endIf:p(n)};for(const e in i){const t=i[e];if(!0===t.start&&(u=e),void 0!==t.moves)for(const n of Object.keys(t.moves))l[e+"."+n]=t.moves[n],c.add(n);void 0===t.endIf&&(t.endIf=()=>{}),void 0===t.onBegin&&(t.onBegin=e=>e),void 0===t.onEnd&&(t.onEnd=e=>e),void 0===t.turn&&(t.turn=a),void 0===t.turn.order&&(t.turn.order=vn),void 0===t.turn.onBegin&&(t.turn.onBegin=e=>e),void 0===t.turn.onEnd&&(t.turn.onEnd=e=>e),void 0===t.turn.endIf&&(t.turn.endIf=()=>!1),void 0===t.turn.onMove&&(t.turn.onMove=e=>e),void 0===t.turn.stages&&(t.turn.stages={});for(const n in t.turn.stages){const r=t.turn.stages[n].moves||{};for(const t of Object.keys(r)){l[e+"."+n+"."+t]=r[t],c.add(t)}}t.wrapped={onBegin:d(t.onBegin),onEnd:d(t.onEnd),endIf:p(t.endIf)},t.turn.wrapped={onMove:d(t.turn.onMove),onBegin:d(t.turn.onBegin),onEnd:d(t.turn.onEnd),endIf:p(t.turn.endIf)}}function v(e){return e.phase?i[e.phase]:i[""]}function m(e){return e}function y(e,t){const n=new Set,r=new Set;for(let a=0;a<t.length;a++){const{fn:o,arg:s,...i}=t[a];if(o===I){r.clear();const t=e.ctx.phase;if(n.has(t)){const t={...e.ctx,phase:null};return{...e,ctx:t}}n.add(t)}const l=[];if(e=o(e,{...i,arg:s,next:l}),o===O)break;const c=P(e);if(c){t.push({fn:O,arg:c,turn:e.ctx.turn,phase:e.ctx.phase,automatic:!0});continue}const u=k(e);if(u)t.push({fn:I,arg:u,turn:e.ctx.turn,phase:e.ctx.phase,automatic:!0});else{if(o===m){const n=E(e);if(n){t.push({fn:j,arg:n,turn:e.ctx.turn,phase:e.ctx.phase,automatic:!0});continue}}t.push(...l)}}return e}function h(e,{next:t}){return t.push({fn:g}),e}function g(e,{next:t}){let{G:n,ctx:r}=e;return n=v(r).wrapped.onBegin(e),t.push({fn:b}),{...e,G:n,ctx:r}}function b(e,{currentPlayer:t}){let{G:n,ctx:r}=e;const a=v(r);t?(r={...r,currentPlayer:t},a.turn.activePlayers&&(r=dn(r,a.turn.activePlayers))):r=function(e,t){let{G:n,ctx:r}=e;const a=nn(e),o=t.order;let s=[...new Array(r.numPlayers)].map((e,t)=>t+"");void 0!==o.playOrder&&(s=o.playOrder(n,a));const i=o.first(n,a),l=typeof i;"number"!==l&&cn(`invalid value returned by turn.order.first — expected number got ${l} “${i}”.`);const c=fn(s,i);return r={...r,currentPlayer:c,playOrderPos:i,playOrder:s},r=dn(r,t.activePlayers||{}),r}(e,a.turn);const o=r.turn+1;return r={...r,turn:o,numMoves:0,_prevActivePlayers:[]},n=a.turn.wrapped.onBegin({...e,G:n,ctx:r}),{...e,G:n,ctx:r,_undo:[],_redo:[]}}function $(e,{arg:t,next:n,phase:r}){const a=v({phase:r});let{ctx:o}=e;if(t&&t.next){if(!(t.next in i))return cn("invalid phase: "+t.next),e;o={...o,phase:t.next}}else o=void 0!==a.next?{...o,phase:a.next}:{...o,phase:null};return e={...e,ctx:o},n.push({fn:g}),e}function x(e,{arg:t,currentPlayer:n,next:r}){let{G:a,ctx:o}=e;const s=v(o),{endPhase:i,ctx:l}=function(e,t,n,r){const a=n.order;let{G:o,ctx:s}=e,i=s.playOrderPos,l=!1;if(r&&!0!==r)"object"!=typeof r&&cn(`invalid argument to endTurn: ${r}`),Object.keys(r).forEach(e=>{switch(e){case"remove":t=fn(s.playOrder,i);break;case"next":i=s.playOrder.indexOf(r.next),t=r.next;break;default:cn(`invalid argument to endTurn: ${e}`)}});else{const n=nn(e),r=a.next(o,n),c=typeof r;void 0!==r&&"number"!==c&&cn(`invalid value returned by turn.order.next — expected number or undefined got ${c} “${r}”.`),void 0===r?l=!0:(i=r,t=fn(s.playOrder,i))}return s={...s,playOrderPos:i,currentPlayer:t},{endPhase:l,ctx:s}}(e,n,s.turn,t);return o=l,e={...e,G:a,ctx:o},i?r.push({fn:I,turn:o.turn,phase:o.phase}):r.push({fn:b,currentPlayer:o.currentPlayer}),e}function w(e,{arg:t,playerID:n}){"string"!=typeof t&&t!==mn.NULL||(t={stage:t});let{ctx:r}=e,{activePlayers:a,_activePlayersMoveLimit:o,_activePlayersNumMoves:s}=r;return void 0!==t.stage&&(null===a&&(a={}),a[n]=t.stage,s[n]=0,t.moveLimit&&(null===o&&(o={}),o[n]=t.moveLimit)),r={...r,activePlayers:a,_activePlayersMoveLimit:o,_activePlayersNumMoves:s},{...e,ctx:r}}function P(e){return f.endIf(e)}function k(e){return v(e.ctx).wrapped.endIf(e)}function E(e){const t=v(e.ctx),n=e.ctx.numMoves||0;return!!(t.turn.moveLimit&&n>=t.turn.moveLimit)||t.turn.wrapped.endIf(e)}function O(e,{arg:t,phase:n}){e=I(e,{phase:n}),void 0===t&&(t=!0),e={...e,ctx:{...e.ctx,gameover:t}};const r=f.onEnd(e);return{...e,G:r}}function I(e,{arg:t,next:n,turn:r,automatic:a}){let o=(e=j(e,{turn:r,force:!0,automatic:!0})).G,s=e.ctx;if(n&&n.push({fn:$,arg:t,phase:s.phase}),null===s.phase)return e;o=v(s).wrapped.onEnd(e),s={...s,phase:null};const i={action:Ce("endPhase",t),_stateID:e._stateID,turn:e.ctx.turn,phase:e.ctx.phase};a&&(i.automatic=!0);const l=[...e.deltalog||[],i];return{...e,G:o,ctx:s,deltalog:l}}function j(e,{arg:t,next:n,turn:r,force:a,automatic:o,playerID:s}){if(r!==e.ctx.turn)return e;let{G:i,ctx:l}=e;const c=v(l),u=l.numMoves||0;if(!a&&c.turn.moveLimit&&u<c.turn.moveLimit)return ln(`cannot end turn before making ${c.turn.moveLimit} moves`),e;if(i=c.turn.wrapped.onEnd(e),n&&n.push({fn:x,arg:t,currentPlayer:l.currentPlayer}),l={...l,activePlayers:null},t&&t.remove){s=s||l.currentPlayer;const t=l.playOrder.filter(e=>e!=s),r=l.playOrderPos>t.length-1?0:l.playOrderPos;if(l={...l,playOrder:t,playOrderPos:r},0===t.length)return n.push({fn:I,turn:l.turn,phase:l.phase}),e}const d={action:Ce("endTurn",t),_stateID:e._stateID,turn:e.ctx.turn,phase:e.ctx.phase};o&&(d.automatic=!0);const p=[...e.deltalog||[],d];return{...e,G:i,ctx:l,deltalog:p,_undo:[],_redo:[]}}function A(e,{arg:t,next:n,automatic:r,playerID:a}){a=a||e.ctx.currentPlayer;let{ctx:o}=e,{activePlayers:s,_activePlayersMoveLimit:i}=o;const l=null!==s&&a in s;if(!t&&l){const e=v(o).turn.stages[s[a]];e&&e.next&&(t=e.next)}if(n&&void 0!==t&&n.push({fn:w,arg:t,playerID:a}),!l)return e;s=Object.keys(s).filter(e=>e!==a).reduce((e,t)=>(e[t]=s[t],e),{}),i&&(i=Object.keys(i).filter(e=>e!==a).reduce((e,t)=>(e[t]=i[t],e),{})),o=function(e){let{activePlayers:t,_activePlayersMoveLimit:n,_activePlayersNumMoves:r,_prevActivePlayers:a}=e;if(t&&0==Object.keys(t).length)if(e._nextActivePlayers)e=dn(e,e._nextActivePlayers),({activePlayers:t,_activePlayersMoveLimit:n,_activePlayersNumMoves:r,_prevActivePlayers:a}=e);else if(a.length>0){const e=a.length-1;({activePlayers:t,_activePlayersMoveLimit:n,_activePlayersNumMoves:r}=a[e]),a=a.slice(0,e)}else t=null,n=null;return{...e,activePlayers:t,_activePlayersMoveLimit:n,_activePlayersNumMoves:r,_prevActivePlayers:a}}({...o,activePlayers:s,_activePlayersMoveLimit:i});const c={action:Ce("endStage",t),_stateID:e._stateID,turn:e.ctx.turn,phase:e.ctx.phase};r&&(c.automatic=!0);const u=[...e.deltalog||[],c];return{...e,ctx:o,deltalog:u}}function _(t,n,r){const a=v(t),o=a.turn.stages,{activePlayers:s}=t;if(s&&void 0!==s[r]&&s[r]!==mn.NULL&&void 0!==o[s[r]]&&void 0!==o[s[r]].moves){const e=o[s[r]].moves;if(n in e)return e[n]}else if(a.moves){if(n in a.moves)return a.moves[n]}else if(n in e)return e[n];return null}const D={endStage:function(e,t){return y(e,[{fn:A,playerID:t}])},setStage:function(e,t,n){return y(e,[{fn:A,arg:n,playerID:t}])},endTurn:function(e,t,n){return y(e,[{fn:j,turn:e.ctx.turn,phase:e.ctx.phase,arg:n}])},pass:function(e,t,n){return y(e,[{fn:j,turn:e.ctx.turn,phase:e.ctx.phase,force:!0,arg:n}])},endPhase:function(e){return y(e,[{fn:I,phase:e.ctx.phase,turn:e.ctx.turn}])},setPhase:function(e,t,n){return y(e,[{fn:I,phase:e.ctx.phase,turn:e.ctx.turn,arg:{next:n}}])},endGame:function(e,t,n){return y(e,[{fn:O,turn:e.ctx.turn,phase:e.ctx.phase,arg:n}])},setActivePlayers:un},S=[];return!1!==o.endTurn&&S.push("endTurn"),!1!==o.pass&&S.push("pass"),!1!==o.endPhase&&S.push("endPhase"),!1!==o.setPhase&&S.push("setPhase"),!1!==o.endGame&&S.push("endGame"),!1!==o.setActivePlayers&&S.push("setActivePlayers"),!1!==o.endStage&&S.push("endStage"),!1!==o.setStage&&S.push("setStage"),{ctx:e=>({numPlayers:e,turn:0,currentPlayer:"0",playOrder:[...new Array(e)].map((e,t)=>t+""),playOrderPos:0,phase:u,activePlayers:null}),init:e=>y(e,[{fn:h}]),isPlayerActive:function(e,t,n){return t.activePlayers?n in t.activePlayers:t.currentPlayer===n},eventHandlers:D,eventNames:Object.keys(D),enabledEventNames:S,moveMap:l,moveNames:[...c.values()],processMove:function(e,t){const n=v(e.ctx),r=_(e.ctx,t.type,t.playerID),a=!r||"function"==typeof r||!0!==r.noLimit,{ctx:o}=e,{_activePlayersNumMoves:s}=o,{playerID:i}=t;let l=e.ctx.numMoves;a&&(i==e.ctx.currentPlayer&&l++,o.activePlayers&&s[i]++),e={...e,ctx:{...o,numMoves:l,_activePlayersNumMoves:s}},o._activePlayersMoveLimit&&s[i]>=o._activePlayersMoveLimit[i]&&(e=A(e,{playerID:i,automatic:!0}));const c=n.turn.wrapped.onMove(e);return y(e={...e,G:c},[{fn:m}])},processEvent:function(e,t){const{type:n,playerID:r,args:a}=t.payload;if(Object.prototype.hasOwnProperty.call(D,n)){const t=[e,r].concat(a);return D[n].apply({},t)}return e},getMove:_}}function hn(e){if(function(e){return void 0!==e.processMove}(e))return e;if(void 0===e.name&&(e.name="default"),void 0===e.deltaState&&(e.deltaState=!1),void 0===e.disableUndo&&(e.disableUndo=!1),void 0===e.setup&&(e.setup=()=>({})),void 0===e.moves&&(e.moves={}),void 0===e.playerView&&(e.playerView=e=>e),void 0===e.plugins&&(e.plugins=[]),e.plugins.forEach(e=>{if(void 0===e.name)throw new Error("Plugin missing name attribute");if(e.name.includes(" "))throw new Error(e.name+": Plugin name must not include spaces")}),e.name.includes(" "))throw new Error(e.name+": Game name must not include spaces");const t=yn(e);return{...e,flow:t,moveNames:t.moveNames,pluginNames:e.plugins.map(e=>e.name),processMove:(n,r)=>{let a=t.getMove(n.ctx,r.type,r.playerID);var o;if((o=a)instanceof Object&&void 0!==o.move&&(a=a.move),a instanceof Function){const t=rn(a,e.plugins),o={...nn(n),playerID:r.playerID};let s=[];return void 0!==r.args&&(s=s.concat(r.args)),t(n.G,o,...s)}return cn(`invalid move object: ${r.type}`),n.G}}}var gn,bn;!function(e){e.UnauthorizedAction="update/unauthorized_action",e.MatchNotFound="update/match_not_found",e.PatchFailed="update/patch_failed"}(gn||(gn={})),function(e){e.StaleStateId="action/stale_state_id",e.UnavailableMove="action/unavailable_move",e.InvalidMove="action/invalid_move",e.InactivePlayer="action/inactive_player",e.GameOver="action/gameover",e.ActionDisabled="action/action_disabled",e.ActionInvalid="action/action_invalid"}(bn||(bn={}));var $n="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};function xn(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}function wn(e,t){return e(t={exports:{}},t.exports),t.exports}var Pn=wn((function(e,t){function n(e){return e.replace(/~1/g,"/").replace(/~0/g,"~")}function r(e){return e.replace(/~/g,"~0").replace(/\//g,"~1")}Object.defineProperty(t,"__esModule",{value:!0}),t.Pointer=void 0;var a=function(){function e(e){void 0===e&&(e=[""]),this.tokens=e}return e.fromJSON=function(t){var r=t.split("/").map(n);if(""!==r[0])throw new Error("Invalid JSON Pointer: "+t);return new e(r)},e.prototype.toString=function(){return this.tokens.map(r).join("/")},e.prototype.evaluate=function(e){for(var t=null,n="",r=e,a=1,o=this.tokens.length;a<o;a++)r=((t=r)||{})[n=this.tokens[a]];return{parent:t,key:n,value:r}},e.prototype.get=function(e){return this.evaluate(e).value},e.prototype.set=function(e,t){for(var n=e,r=1,a=this.tokens.length-1,o=this.tokens[r];r<a;r++)n=(n||{})[o];n&&(n[this.tokens[this.tokens.length-1]]=t)},e.prototype.push=function(e){this.tokens.push(e)},e.prototype.add=function(t){return new e(this.tokens.concat(String(t)))},e}();t.Pointer=a}));xn(Pn);Pn.Pointer;var kn=wn((function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.clone=t.objectType=t.hasOwnProperty=void 0,t.hasOwnProperty=Object.prototype.hasOwnProperty,t.objectType=function(e){return void 0===e?"undefined":null===e?"null":Array.isArray(e)?"array":typeof e},t.clone=function e(n){if(null==(r=n)||"object"!=typeof r)return n;var r;if(n.constructor==Array){for(var a=n.length,o=new Array(a),s=0;s<a;s++)o[s]=e(n[s]);return o}var i={};for(var l in n)t.hasOwnProperty.call(n,l)&&(i[l]=e(n[l]));return i}}));xn(kn);kn.clone,kn.objectType;var En=wn((function(e,t){function n(e,t){var n={};for(var r in e)kn.hasOwnProperty.call(e,r)&&void 0!==e[r]&&(n[r]=1);for(var a in t)kn.hasOwnProperty.call(t,a)&&void 0!==t[a]&&delete n[a];return Object.keys(n)}function r(e){for(var t=e.length,n={},r=0;r<t;r++){var a=e[r];for(var o in a)kn.hasOwnProperty.call(a,o)&&void 0!==a[o]&&(n[o]=(n[o]||0)+1)}for(var o in n)n[o]<t&&delete n[o];return Object.keys(n)}function a(e,t){return{operations:e.operations.concat(t),cost:e.cost+1}}function o(e,t,n,r){void 0===r&&(r=i);var o={"0,0":{operations:[],cost:0}};var s=isNaN(e.length)||e.length<=0?0:e.length,l=isNaN(t.length)||t.length<=0?0:t.length;return function n(s,i){var l=s+","+i,c=o[l];if(void 0===c){if(s>0&&i>0&&!r(e[s-1],t[i-1],new Pn.Pointer).length)c=n(s-1,i-1);else{var u=[];if(s>0){var d=n(s-1,i),p={op:"remove",index:s-1};u.push(a(d,p))}if(i>0){var f=n(s,i-1),v={op:"add",index:s-1,value:t[i-1]};u.push(a(f,v))}if(s>0&&i>0){var m=n(s-1,i-1),y={op:"replace",index:s-1,original:e[s-1],value:t[i-1]};u.push(a(m,y))}c=u.sort((function(e,t){return e.cost-t.cost}))[0]}o[l]=c}return c}(s,l).operations.reduce((function(e,t){var a=e[0],o=e[1];if(function(e){return"add"===e.op}(t)){var i=t.index+1+o,l=i<s+o?String(i):"-",c={op:t.op,path:n.add(l).toString(),value:t.value};return[a.concat(c),o+1]}if(function(e){return"remove"===e.op}(t)){c={op:t.op,path:n.add(String(t.index+o)).toString()};return[a.concat(c),o-1]}var u=n.add(String(t.index+o)),d=r(t.original,t.value,u);return[a.concat.apply(a,d),o]}),[[],0])[0]}function s(e,t,a,o){void 0===o&&(o=i);var s=[];return n(e,t).forEach((function(e){s.push({op:"remove",path:a.add(e).toString()})})),n(t,e).forEach((function(e){s.push({op:"add",path:a.add(e).toString(),value:t[e]})})),r([e,t]).forEach((function(n){s.push.apply(s,o(e[n],t[n],a.add(n)))})),s}function i(e,t,n,r){if(void 0===r&&(r=i),e===t)return[];var a=kn.objectType(e),l=kn.objectType(t);return"array"==a&&"array"==l?o(e,t,n,r):"object"==a&&"object"==l?s(e,t,n,r):[{op:"replace",path:n.toString(),value:t}]}Object.defineProperty(t,"__esModule",{value:!0}),t.diffAny=t.diffObjects=t.diffArrays=t.intersection=t.subtract=t.isDestructive=void 0,t.isDestructive=function(e){var t=e.op;return"remove"===t||"replace"===t||"copy"===t||"move"===t},t.subtract=n,t.intersection=r,t.diffArrays=o,t.diffObjects=s,t.diffAny=i}));xn(En);En.diffAny,En.diffObjects,En.diffArrays,En.intersection,En.subtract,En.isDestructive;var On=wn((function(e,t){var n,r=$n&&$n.__extends||(n=function(e,t){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])})(e,t)},function(e,t){function r(){this.constructor=e}n(e,t),e.prototype=null===t?Object.create(t):(r.prototype=t.prototype,new r)});Object.defineProperty(t,"__esModule",{value:!0}),t.apply=t.InvalidOperationError=t.test=t.copy=t.move=t.replace=t.remove=t.add=t.TestError=t.MissingError=void 0;var a=function(e){function t(t){var n=e.call(this,"Value required at path: "+t)||this;return n.path=t,n.name="MissingError",n}return r(t,e),t}(Error);t.MissingError=a;var o=function(e){function t(t,n){var r=e.call(this,"Test failed: "+t+" != "+n)||this;return r.actual=t,r.expected=n,r.name="TestError",r}return r(t,e),t}(Error);function s(e,t,n){if(Array.isArray(e))if("-"==t)e.push(n);else{var r=parseInt(t,10);e.splice(r,0,n)}else e[t]=n}function i(e,t){if(Array.isArray(e)){var n=parseInt(t,10);e.splice(n,1)}else delete e[t]}function l(e,t){var n=Pn.Pointer.fromJSON(t.path).evaluate(e);return void 0===n.parent?new a(t.path):(s(n.parent,n.key,kn.clone(t.value)),null)}function c(e,t){var n=Pn.Pointer.fromJSON(t.path).evaluate(e);return void 0===n.value?new a(t.path):(i(n.parent,n.key),null)}function u(e,t){var n=Pn.Pointer.fromJSON(t.path).evaluate(e);if(null===n.parent)return new a(t.path);if(Array.isArray(n.parent)){if(parseInt(n.key,10)>=n.parent.length)return new a(t.path)}else if(void 0===n.value)return new a(t.path);return n.parent[n.key]=t.value,null}function d(e,t){var n=Pn.Pointer.fromJSON(t.from).evaluate(e);if(void 0===n.value)return new a(t.from);var r=Pn.Pointer.fromJSON(t.path).evaluate(e);return void 0===r.parent?new a(t.path):(i(n.parent,n.key),s(r.parent,r.key,n.value),null)}function p(e,t){var n=Pn.Pointer.fromJSON(t.from).evaluate(e);if(void 0===n.value)return new a(t.from);var r=Pn.Pointer.fromJSON(t.path).evaluate(e);return void 0===r.parent?new a(t.path):(s(r.parent,r.key,kn.clone(n.value)),null)}function f(e,t){var n=Pn.Pointer.fromJSON(t.path).evaluate(e);return En.diffAny(n.value,t.value,new Pn.Pointer).length?new o(n.value,t.value):null}t.TestError=o,t.add=l,t.remove=c,t.replace=u,t.move=d,t.copy=p,t.test=f;var v=function(e){function t(t){var n=e.call(this,"Invalid operation: "+t.op)||this;return n.operation=t,n.name="InvalidOperationError",n}return r(t,e),t}(Error);t.InvalidOperationError=v,t.apply=function(e,t){switch(t.op){case"add":return l(e,t);case"remove":return c(e,t);case"replace":return u(e,t);case"move":return d(e,t);case"copy":return p(e,t);case"test":return f(e,t)}return new v(t)}}));xn(On);On.apply,On.InvalidOperationError,On.test,On.copy,On.move,On.replace,On.remove,On.add,On.TestError,On.MissingError;var In=wn((function(e,t){function n(e,t){var n=Pn.Pointer.fromJSON(t).evaluate(e);if(void 0!==n)return{op:"test",path:t,value:n.value}}Object.defineProperty(t,"__esModule",{value:!0}),t.createTests=t.createPatch=t.applyPatch=void 0,t.applyPatch=function(e,t){return t.map((function(t){return On.apply(e,t)}))},t.createPatch=function(e,t,n){var r=new Pn.Pointer;return(n?function(e){return function t(n,r,a){var o=e(n,r,a);return Array.isArray(o)?o:En.diffAny(n,r,a,t)}}(n):En.diffAny)(e,t,r)},t.createTests=function(e,t){var r=new Array;return t.filter(En.isDestructive).forEach((function(t){var a=n(e,t.path);if(a&&r.push(a),"from"in t){var o=n(e,t.from);o&&r.push(o)}})),r}}));xn(In);In.createTests,In.createPatch;var jn=In.applyPatch;const An=e=>null!==e.payload.playerID&&void 0!==e.payload.playerID;function _n(e,t){if(t.game.disableUndo)return e;const n={G:e.G,ctx:e.ctx,plugins:e.plugins,playerID:t.action.payload.playerID||e.ctx.currentPlayer};return"MAKE_MOVE"===t.action.type&&(n.moveType=t.action.payload.type),{...e,_undo:[...e._undo,n],_redo:[]}}function Dn(e,t,n){const r={action:t,_stateID:e._stateID,turn:e.ctx.turn,phase:e.ctx.phase},a=e.plugins.log.data.metadata;return void 0!==a&&(r.metadata=a),"object"==typeof n&&!0===n.redact&&(r.redact=!0),{...e,deltalog:[r]}}function Sn(e){if(!e)return[null,void 0];const{transients:t,...n}=e;return[n,t]}function Mn(e,t,n){return{...e,transients:{error:{type:t,payload:n}}}}const Cn=e=>t=>n=>{const r=t(n);switch(n.type){case"STRIP_TRANSIENTS":return r;default:{const[,t]=Sn(e.getState());return void 0!==t?(e.dispatch({type:"STRIP_TRANSIENTS"}),{...r,transients:t}):r}}};function Nn({game:e,isClient:t}){return e=hn(e),(n=null,r)=>{let[a]=Sn(n);switch(r.type){case"STRIP_TRANSIENTS":return a;case"GAME_EVENT":{if(a={...a,deltalog:[]},t)return a;if(void 0!==a.ctx.gameover)return cn("cannot call event after game end"),Mn(a,bn.GameOver);if(An(r)&&!e.flow.isPlayerActive(a.G,a.ctx,r.payload.playerID))return cn(`disallowed event: ${r.payload.type}`),Mn(a,bn.InactivePlayer);a=an(a,{game:e,isClient:!1,playerID:r.payload.playerID});let n=e.flow.processEvent(a,r);return n=on(n,{game:e,isClient:!1}),n=_n(n,{game:e,action:r}),{...n,_stateID:a._stateID+1}}case"MAKE_MOVE":{a={...a,deltalog:[]};const n=e.flow.getMove(a.ctx,r.payload.type,r.payload.playerID||a.ctx.currentPlayer);if(null===n)return cn(`disallowed move: ${r.payload.type}`),Mn(a,bn.UnavailableMove);if(t&&!1===n.client)return a;if(void 0!==a.ctx.gameover)return cn("cannot make move after game end"),Mn(a,bn.GameOver);if(An(r)&&!e.flow.isPlayerActive(a.G,a.ctx,r.payload.playerID))return cn(`disallowed move: ${r.payload.type}`),Mn(a,bn.InactivePlayer);a=an(a,{game:e,isClient:t,playerID:r.payload.playerID});const o=e.processMove(a,r.payload);if("INVALID_MOVE"===o)return cn(`invalid move: ${r.payload.type} args: ${r.payload.args}`),Mn(a,bn.InvalidMove);const s={...a,G:o};return t&&((e,t)=>[...tn,...t.game.plugins].filter(e=>void 0!==e.noClient).map(n=>{const r=n.name,a=e.plugins[r];return!!a&&n.noClient({G:e.G,ctx:e.ctx,game:t.game,api:a.api,data:a.data})}).some(e=>!0===e))(s,{game:e})?a:(a=s,t?(a=on(a,{game:e,isClient:!0}),{...a,_stateID:a._stateID+1}):(a=Dn(a,r,n),a=e.flow.processMove(a,r.payload),a=on(a,{game:e}),a=_n(a,{game:e,action:r}),{...a,_stateID:a._stateID+1}))}case"RESET":case"UPDATE":case"SYNC":return r.state;case"UNDO":{if(a={...a,deltalog:[]},e.disableUndo)return cn("Undo is not enabled"),Mn(a,bn.ActionDisabled);const{_undo:t,_redo:n}=a;if(t.length<2)return cn("No moves to undo"),Mn(a,bn.ActionInvalid);const o=t[t.length-1],s=t[t.length-2];if(An(r)&&r.payload.playerID!==o.playerID)return cn("Cannot undo other players' moves"),Mn(a,bn.ActionInvalid);if(o.moveType){const t=e.flow.getMove(s.ctx,o.moveType,o.playerID);if(!((e,t,n)=>!function(e){return void 0!==e.undoable}(n)||(n.undoable instanceof Function?n.undoable(e,t):n.undoable))(a.G,a.ctx,t))return cn("Move cannot be undone"),Mn(a,bn.ActionInvalid)}return a=Dn(a,r),{...a,G:s.G,ctx:s.ctx,plugins:s.plugins,_stateID:a._stateID+1,_undo:t.slice(0,-1),_redo:[o,...n]}}case"REDO":{if(a={...a,deltalog:[]},e.disableUndo)return cn("Redo is not enabled"),Mn(a,bn.ActionDisabled);const{_undo:t,_redo:n}=a;if(0==n.length)return cn("No moves to redo"),Mn(a,bn.ActionInvalid);const o=n[0];return An(r)&&r.payload.playerID!==o.playerID?(cn("Cannot redo other players' moves"),Mn(a,bn.ActionInvalid)):(a=Dn(a,r),{...a,G:o.G,ctx:o.ctx,plugins:o.plugins,_stateID:a._stateID+1,_undo:[...t,o],_redo:n.slice(1)})}case"PLUGIN":return((e,t,n)=>(n.game.plugins.filter(e=>void 0!==e.action).filter(e=>e.name===t.payload.type).forEach(n=>{const r=n.name,a=e.plugins[r]||{data:{}},o=n.action(a.data,t.payload);e={...e,plugins:{...e.plugins,[r]:{...a,data:o}}}}),e))(a,r,{game:e});case"PATCH":{const e=a,t=JSON.parse(JSON.stringify(e)),n=jn(t,r.patch);return n.some(e=>null!==e)?(cn(`Patch ${JSON.stringify(r.patch)} apply failed`),Mn(e,gn.PatchFailed,n)):t}default:return a}}}function Tn({game:e,numPlayers:t,setupData:n}){t||(t=2);let r={G:{},ctx:(e=hn(e)).flow.ctx(t),plugins:{}};r=((e,t)=>([...tn,...t.game.plugins].filter(e=>void 0!==e.setup).forEach(n=>{const r=n.name,a=n.setup({G:e.G,ctx:e.ctx,game:t.game});e={...e,plugins:{...e.plugins,[r]:{data:a}}}}),e))(r,{game:e}),r=an(r,{game:e,playerID:void 0});const a=nn(r);r.G=e.setup(a,n);let o={...r,_undo:[],_redo:[],_stateID:0};return o=e.flow.init(o),o=on(o,{game:e}),e.disableUndo||(o._undo=[{G:o.G,ctx:o.ctx,plugins:o.plugins}]),o}class zn extends class{constructor({store:e,gameName:t,playerID:n,matchID:r,credentials:a,numPlayers:o}){this.store=e,this.gameName=t||"default",this.playerID=n||null,this.matchID=r||"default",this.credentials=a,this.numPlayers=o||2}}{connect(){}disconnect(){}onAction(){}onChatMessage(){}subscribe(){}subscribeChatMessage(){}subscribeMatchData(){}updateCredentials(){}updateMatchID(){}updatePlayerID(){}}const Gn=e=>new zn(e),qn=[];function Bn(e,t=n){let r;const a=[];function o(t){if(c(e,t)&&(e=t,r)){const t=!qn.length;for(let t=0;t<a.length;t+=1){const n=a[t];n[1](),qn.push(n,e)}if(t){for(let e=0;e<qn.length;e+=2)qn[e][0](qn[e+1]);qn.length=0}}}return{set:o,update:function(t){o(t(e))},subscribe:function(s,i=n){const l=[s,i];return a.push(l),1===a.length&&(r=t(o)||n),s(e),()=>{const e=a.indexOf(l);-1!==e&&a.splice(e,1),0===a.length&&(r(),r=null)}}}}function Ln(e){const t=e-1;return t*t*t+1}function Rn(e,{delay:t=0,duration:n=400,easing:r=Ln,x:a=0,y:o=0,opacity:s=0}){const i=getComputedStyle(e),l=+i.opacity,c="none"===i.transform?"":i.transform,u=l*(1-s);return{delay:t,duration:n,easing:r,css:(e,t)=>`\n\t\t\ttransform: ${c} translate(${(1-e)*a}px, ${(1-e)*o}px);\n\t\t\topacity: ${l-u*t}`}}function Un(e,t,n){const r=e.slice();return r[4]=t[n][0],r[5]=t[n][1].label,r}function Vn(e){let t,n,r,a,o,s=e[5]+"";function i(...t){return e[3](e[4],...t)}return{c(){t=E("button"),n=I(s),r=j(),D(t,"class","menu-item svelte-14p9tpy"),T(t,"active",e[0]==e[4])},m(e,s){w(e,t,s),x(t,n),x(t,r),a||(o=_(t,"click",i),a=!0)},p(r,a){e=r,2&a&&s!==(s=e[5]+"")&&S(n,s),3&a&&T(t,"active",e[0]==e[4])},d(e){e&&P(t),a=!1,o()}}}function Jn(e){let t,r=Object.entries(e[1]),a=[];for(let t=0;t<r.length;t+=1)a[t]=Vn(Un(e,r,t));return{c(){t=E("nav");for(let e=0;e<a.length;e+=1)a[e].c();D(t,"class","menu svelte-14p9tpy")},m(e,n){w(e,t,n);for(let e=0;e<a.length;e+=1)a[e].m(t,null)},p(e,[n]){if(7&n){let o;for(r=Object.entries(e[1]),o=0;o<r.length;o+=1){const s=Un(e,r,o);a[o]?a[o].p(s,n):(a[o]=Vn(s),a[o].c(),a[o].m(t,null))}for(;o<a.length;o+=1)a[o].d(1);a.length=r.length}},i:n,o:n,d(e){e&&P(t),k(a,e)}}}function Kn(e,t,n){let{pane:r}=t,{panes:a}=t;const o=K();return e.$set=e=>{"pane"in e&&n(0,r=e.pane),"panes"in e&&n(1,a=e.panes)},[r,a,o,e=>o("change",e)]}class Fn extends Pe{constructor(e){var t;super(),document.getElementById("svelte-14p9tpy-style")||((t=E("style")).id="svelte-14p9tpy-style",t.textContent=".menu.svelte-14p9tpy{display:flex;margin-top:-10px;flex-direction:row-reverse;border:1px solid #ccc;border-radius:5px 5px 0 0;height:25px;line-height:25px;margin-right:-500px;transform-origin:bottom right;transform:rotate(-90deg) translate(0, -500px)}.menu-item.svelte-14p9tpy{line-height:25px;cursor:pointer;border:0;background:#fefefe;color:#555;padding-left:15px;padding-right:15px;text-align:center}.menu-item.svelte-14p9tpy:first-child{border-radius:0 5px 0 0}.menu-item.svelte-14p9tpy:last-child{border-radius:5px 0 0 0}.menu-item.active.svelte-14p9tpy{cursor:default;font-weight:bold;background:#ddd;color:#555}.menu-item.svelte-14p9tpy:hover,.menu-item.svelte-14p9tpy:focus{background:#eee;color:#555}",x(document.head,t)),we(this,e,Kn,Jn,c,{pane:0,panes:1})}}var Wn={};function Hn(e){let t,r,a,o;return{c(){t=E("div"),r=E("div"),r.textContent="▶",D(r,"class","arrow svelte-1vyml86"),T(r,"expanded",e[0]),D(t,"class","container svelte-1vyml86")},m(n,s){w(n,t,s),x(t,r),a||(o=_(t,"click",e[1]),a=!0)},p(e,[t]){1&t&&T(r,"expanded",e[0])},i:n,o:n,d(e){e&&P(t),a=!1,o()}}}function Yn(e,t,n){let{expanded:r}=t;return e.$set=e=>{"expanded"in e&&n(0,r=e.expanded)},[r,function(t){H(e,t)}]}class Xn extends Pe{constructor(e){var t;super(),document.getElementById("svelte-1vyml86-style")||((t=E("style")).id="svelte-1vyml86-style",t.textContent=".container.svelte-1vyml86{display:inline-block;cursor:pointer;transform:translate(calc(0px - var(--li-identation)), -50%);position:absolute;top:50%;padding-right:100%}.arrow.svelte-1vyml86{transform-origin:25% 50%;position:relative;line-height:1.1em;font-size:0.75em;margin-left:0;transition:150ms;color:var(--arrow-sign);user-select:none;font-family:'Courier New', Courier, monospace}.expanded.svelte-1vyml86{transform:rotateZ(90deg) translateX(-3px)}",x(document.head,t)),we(this,e,Yn,Hn,c,{expanded:0})}}function Zn(e){let t,n,r,a,o,s;return{c(){t=E("label"),n=E("span"),r=I(e[0]),a=I(e[2]),D(t,"class","svelte-1vlbacg"),T(t,"spaced",e[1])},m(i,l){w(i,t,l),x(t,n),x(n,r),x(n,a),o||(s=_(t,"click",e[5]),o=!0)},p(e,n){1&n&&S(r,e[0]),4&n&&S(a,e[2]),2&n&&T(t,"spaced",e[1])},d(e){e&&P(t),o=!1,s()}}}function Qn(e){let t,r=e[3]&&e[0]&&Zn(e);return{c(){r&&r.c(),t=A()},m(e,n){r&&r.m(e,n),w(e,t,n)},p(e,[n]){e[3]&&e[0]?r?r.p(e,n):(r=Zn(e),r.c(),r.m(t.parentNode,t)):r&&(r.d(1),r=null)},i:n,o:n,d(e){r&&r.d(e),e&&P(t)}}}function er(e,t,n){let r,{key:a}=t,{isParentExpanded:o}=t,{isParentArray:s=!1}=t,{colon:i=":"}=t;return e.$set=e=>{"key"in e&&n(0,a=e.key),"isParentExpanded"in e&&n(1,o=e.isParentExpanded),"isParentArray"in e&&n(4,s=e.isParentArray),"colon"in e&&n(2,i=e.colon)},e.$$.update=()=>{19&e.$$.dirty&&n(3,r=o||!s||a!=+a)},[a,o,i,r,s,function(t){H(e,t)}]}class tr extends Pe{constructor(e){var t;super(),document.getElementById("svelte-1vlbacg-style")||((t=E("style")).id="svelte-1vlbacg-style",t.textContent="label.svelte-1vlbacg{display:inline-block;color:var(--label-color);padding:0}.spaced.svelte-1vlbacg{padding-right:var(--li-colon-space)}",x(document.head,t)),we(this,e,er,Qn,c,{key:0,isParentExpanded:1,isParentArray:4,colon:2})}}function nr(e,t,n){const r=e.slice();return r[12]=t[n],r[20]=n,r}function rr(e){let t,n;return t=new Xn({props:{expanded:e[0]}}),t.$on("click",e[15]),{c(){ge(t.$$.fragment)},m(e,r){be(t,e,r),n=!0},p(e,n){const r={};1&n&&(r.expanded=e[0]),t.$set(r)},i(e){n||(fe(t.$$.fragment,e),n=!0)},o(e){ve(t.$$.fragment,e),n=!1},d(e){$e(t,e)}}}function ar(e){let t;return{c(){t=E("span"),t.textContent="…"},m(e,n){w(e,t,n)},p:n,i:n,o:n,d(e){e&&P(t)}}}function or(e){let t,n,r,a,o,s=e[13],i=[];for(let t=0;t<s.length;t+=1)i[t]=ir(nr(e,s,t));const l=e=>ve(i[e],1,1,()=>{i[e]=null});let c=e[13].length<e[7].length&&lr();return{c(){t=E("ul");for(let e=0;e<i.length;e+=1)i[e].c();n=j(),c&&c.c(),D(t,"class","svelte-rwxv37"),T(t,"collapse",!e[0])},m(s,l){w(s,t,l);for(let e=0;e<i.length;e+=1)i[e].m(t,null);x(t,n),c&&c.m(t,null),r=!0,a||(o=_(t,"click",e[16]),a=!0)},p(e,r){if(10129&r){let a;for(s=e[13],a=0;a<s.length;a+=1){const o=nr(e,s,a);i[a]?(i[a].p(o,r),fe(i[a],1)):(i[a]=ir(o),i[a].c(),fe(i[a],1),i[a].m(t,n))}for(de(),a=s.length;a<i.length;a+=1)l(a);pe()}e[13].length<e[7].length?c||(c=lr(),c.c(),c.m(t,null)):c&&(c.d(1),c=null),1&r&&T(t,"collapse",!e[0])},i(e){if(!r){for(let e=0;e<s.length;e+=1)fe(i[e]);r=!0}},o(e){i=i.filter(Boolean);for(let e=0;e<i.length;e+=1)ve(i[e]);r=!1},d(e){e&&P(t),k(i,e),c&&c.d(),a=!1,o()}}}function sr(e){let t;return{c(){t=E("span"),t.textContent=",",D(t,"class","comma svelte-rwxv37")},m(e,n){w(e,t,n)},d(e){e&&P(t)}}}function ir(e){let t,n,r,a;t=new Jr({props:{key:e[8](e[12]),isParentExpanded:e[0],isParentArray:e[4],value:e[0]?e[9](e[12]):e[10](e[12])}});let o=!e[0]&&e[20]<e[7].length-1&&sr();return{c(){ge(t.$$.fragment),n=j(),o&&o.c(),r=A()},m(e,s){be(t,e,s),w(e,n,s),o&&o.m(e,s),w(e,r,s),a=!0},p(e,n){const a={};8448&n&&(a.key=e[8](e[12])),1&n&&(a.isParentExpanded=e[0]),16&n&&(a.isParentArray=e[4]),9729&n&&(a.value=e[0]?e[9](e[12]):e[10](e[12])),t.$set(a),!e[0]&&e[20]<e[7].length-1?o||(o=sr(),o.c(),o.m(r.parentNode,r)):o&&(o.d(1),o=null)},i(e){a||(fe(t.$$.fragment,e),a=!0)},o(e){ve(t.$$.fragment,e),a=!1},d(e){$e(t,e),e&&P(n),o&&o.d(e),e&&P(r)}}}function lr(e){let t;return{c(){t=E("span"),t.textContent="…"},m(e,n){w(e,t,n)},d(e){e&&P(t)}}}function cr(e){let t,n,r,a,o,s,i,l,c,u,d,p,f,v,m,y,h,g,b=e[11]&&e[2]&&rr(e);a=new tr({props:{key:e[12],colon:e[14].colon,isParentExpanded:e[2],isParentArray:e[3]}}),a.$on("click",e[15]);const $=[or,ar],k=[];function O(e,t){return e[2]?0:1}return d=O(e),p=k[d]=$[d](e),{c(){t=E("li"),n=E("label"),b&&b.c(),r=j(),ge(a.$$.fragment),o=j(),s=E("span"),i=E("span"),l=I(e[1]),c=I(e[5]),u=j(),p.c(),f=j(),v=E("span"),m=I(e[6]),D(n,"class","svelte-rwxv37"),D(t,"class","svelte-rwxv37"),T(t,"indent",e[2])},m(p,$){w(p,t,$),x(t,n),b&&b.m(n,null),x(n,r),be(a,n,null),x(n,o),x(n,s),x(s,i),x(i,l),x(s,c),x(t,u),k[d].m(t,null),x(t,f),x(t,v),x(v,m),y=!0,h||(g=_(s,"click",e[15]),h=!0)},p(e,[o]){e[11]&&e[2]?b?(b.p(e,o),2052&o&&fe(b,1)):(b=rr(e),b.c(),fe(b,1),b.m(n,r)):b&&(de(),ve(b,1,1,()=>{b=null}),pe());const s={};4096&o&&(s.key=e[12]),4&o&&(s.isParentExpanded=e[2]),8&o&&(s.isParentArray=e[3]),a.$set(s),(!y||2&o)&&S(l,e[1]),(!y||32&o)&&S(c,e[5]);let i=d;d=O(e),d===i?k[d].p(e,o):(de(),ve(k[i],1,1,()=>{k[i]=null}),pe(),p=k[d],p||(p=k[d]=$[d](e),p.c()),fe(p,1),p.m(t,f)),(!y||64&o)&&S(m,e[6]),4&o&&T(t,"indent",e[2])},i(e){y||(fe(b),fe(a.$$.fragment,e),fe(p),y=!0)},o(e){ve(b),ve(a.$$.fragment,e),ve(p),y=!1},d(e){e&&P(t),b&&b.d(),$e(a),k[d].d(),h=!1,g()}}}function ur(e,t,n){let{key:r}=t,{keys:a}=t,{colon:o=":"}=t,{label:s=""}=t,{isParentExpanded:i}=t,{isParentArray:l}=t,{isArray:c=!1}=t,{bracketOpen:u}=t,{bracketClose:d}=t,{previewKeys:p=a}=t,{getKey:f=(e=>e)}=t,{getValue:v=(e=>e)}=t,{getPreviewValue:m=v}=t,{expanded:y=!1}=t,{expandable:h=!0}=t;const g=W(Wn);let b;return F(Wn,{...g,colon:o}),e.$set=e=>{"key"in e&&n(12,r=e.key),"keys"in e&&n(17,a=e.keys),"colon"in e&&n(18,o=e.colon),"label"in e&&n(1,s=e.label),"isParentExpanded"in e&&n(2,i=e.isParentExpanded),"isParentArray"in e&&n(3,l=e.isParentArray),"isArray"in e&&n(4,c=e.isArray),"bracketOpen"in e&&n(5,u=e.bracketOpen),"bracketClose"in e&&n(6,d=e.bracketClose),"previewKeys"in e&&n(7,p=e.previewKeys),"getKey"in e&&n(8,f=e.getKey),"getValue"in e&&n(9,v=e.getValue),"getPreviewValue"in e&&n(10,m=e.getPreviewValue),"expanded"in e&&n(0,y=e.expanded),"expandable"in e&&n(11,h=e.expandable)},e.$$.update=()=>{4&e.$$.dirty&&(i||n(0,y=!1)),131201&e.$$.dirty&&n(13,b=y?a:p.slice(0,5))},[y,s,i,l,c,u,d,p,f,v,m,h,r,b,g,function(){n(0,y=!y)},function(){n(0,y=!0)},a,o]}class dr extends Pe{constructor(e){var t;super(),document.getElementById("svelte-rwxv37-style")||((t=E("style")).id="svelte-rwxv37-style",t.textContent="label.svelte-rwxv37{display:inline-block}.indent.svelte-rwxv37{padding-left:var(--li-identation)}.collapse.svelte-rwxv37{--li-display:inline;display:inline;font-style:italic}.comma.svelte-rwxv37{margin-left:-0.5em;margin-right:0.5em}label.svelte-rwxv37{position:relative}",x(document.head,t)),we(this,e,ur,cr,c,{key:12,keys:17,colon:18,label:1,isParentExpanded:2,isParentArray:3,isArray:4,bracketOpen:5,bracketClose:6,previewKeys:7,getKey:8,getValue:9,getPreviewValue:10,expanded:0,expandable:11})}}function pr(e){let t,n;return t=new dr({props:{key:e[0],expanded:e[4],isParentExpanded:e[1],isParentArray:e[2],keys:e[5],previewKeys:e[5],getValue:e[6],label:e[3]+" ",bracketOpen:"{",bracketClose:"}"}}),{c(){ge(t.$$.fragment)},m(e,r){be(t,e,r),n=!0},p(e,[n]){const r={};1&n&&(r.key=e[0]),16&n&&(r.expanded=e[4]),2&n&&(r.isParentExpanded=e[1]),4&n&&(r.isParentArray=e[2]),32&n&&(r.keys=e[5]),32&n&&(r.previewKeys=e[5]),8&n&&(r.label=e[3]+" "),t.$set(r)},i(e){n||(fe(t.$$.fragment,e),n=!0)},o(e){ve(t.$$.fragment,e),n=!1},d(e){$e(t,e)}}}function fr(e,t,n){let r,{key:a}=t,{value:o}=t,{isParentExpanded:s}=t,{isParentArray:i}=t,{nodeType:l}=t,{expanded:c=!0}=t;return e.$set=e=>{"key"in e&&n(0,a=e.key),"value"in e&&n(7,o=e.value),"isParentExpanded"in e&&n(1,s=e.isParentExpanded),"isParentArray"in e&&n(2,i=e.isParentArray),"nodeType"in e&&n(3,l=e.nodeType),"expanded"in e&&n(4,c=e.expanded)},e.$$.update=()=>{128&e.$$.dirty&&n(5,r=Object.getOwnPropertyNames(o))},[a,s,i,l,c,r,function(e){return o[e]},o]}class vr extends Pe{constructor(e){super(),we(this,e,fr,pr,c,{key:0,value:7,isParentExpanded:1,isParentArray:2,nodeType:3,expanded:4})}}function mr(e){let t,n;return t=new dr({props:{key:e[0],expanded:e[4],isParentExpanded:e[2],isParentArray:e[3],isArray:!0,keys:e[5],previewKeys:e[6],getValue:e[7],label:"Array("+e[1].length+")",bracketOpen:"[",bracketClose:"]"}}),{c(){ge(t.$$.fragment)},m(e,r){be(t,e,r),n=!0},p(e,[n]){const r={};1&n&&(r.key=e[0]),16&n&&(r.expanded=e[4]),4&n&&(r.isParentExpanded=e[2]),8&n&&(r.isParentArray=e[3]),32&n&&(r.keys=e[5]),64&n&&(r.previewKeys=e[6]),2&n&&(r.label="Array("+e[1].length+")"),t.$set(r)},i(e){n||(fe(t.$$.fragment,e),n=!0)},o(e){ve(t.$$.fragment,e),n=!1},d(e){$e(t,e)}}}function yr(e,t,n){let{key:r}=t,{value:a}=t,{isParentExpanded:o}=t,{isParentArray:s}=t,{expanded:i=JSON.stringify(a).length<1024}=t;const l=new Set(["length"]);let c,u;return e.$set=e=>{"key"in e&&n(0,r=e.key),"value"in e&&n(1,a=e.value),"isParentExpanded"in e&&n(2,o=e.isParentExpanded),"isParentArray"in e&&n(3,s=e.isParentArray),"expanded"in e&&n(4,i=e.expanded)},e.$$.update=()=>{2&e.$$.dirty&&n(5,c=Object.getOwnPropertyNames(a)),32&e.$$.dirty&&n(6,u=c.filter(e=>!l.has(e)))},[r,a,o,s,i,c,u,function(e){return a[e]}]}class hr extends Pe{constructor(e){super(),we(this,e,yr,mr,c,{key:0,value:1,isParentExpanded:2,isParentArray:3,expanded:4})}}function gr(e){let t,n;return t=new dr({props:{key:e[0],isParentExpanded:e[1],isParentArray:e[2],keys:e[4],getKey:br,getValue:$r,isArray:!0,label:e[3]+"("+e[4].length+")",bracketOpen:"{",bracketClose:"}"}}),{c(){ge(t.$$.fragment)},m(e,r){be(t,e,r),n=!0},p(e,[n]){const r={};1&n&&(r.key=e[0]),2&n&&(r.isParentExpanded=e[1]),4&n&&(r.isParentArray=e[2]),16&n&&(r.keys=e[4]),24&n&&(r.label=e[3]+"("+e[4].length+")"),t.$set(r)},i(e){n||(fe(t.$$.fragment,e),n=!0)},o(e){ve(t.$$.fragment,e),n=!1},d(e){$e(t,e)}}}function br(e){return String(e[0])}function $r(e){return e[1]}function xr(e,t,n){let{key:r}=t,{value:a}=t,{isParentExpanded:o}=t,{isParentArray:s}=t,{nodeType:i}=t,l=[];return e.$set=e=>{"key"in e&&n(0,r=e.key),"value"in e&&n(5,a=e.value),"isParentExpanded"in e&&n(1,o=e.isParentExpanded),"isParentArray"in e&&n(2,s=e.isParentArray),"nodeType"in e&&n(3,i=e.nodeType)},e.$$.update=()=>{if(32&e.$$.dirty){let e=[],t=0;for(const n of a)e.push([t++,n]);n(4,l=e)}},[r,o,s,i,l,a]}class wr extends Pe{constructor(e){super(),we(this,e,xr,gr,c,{key:0,value:5,isParentExpanded:1,isParentArray:2,nodeType:3})}}class Pr{constructor(e,t){this.key=e,this.value=t}}function kr(e){let t,n;return t=new dr({props:{key:e[0],isParentExpanded:e[1],isParentArray:e[2],keys:e[4],getKey:Er,getValue:Or,label:e[3]+"("+e[4].length+")",colon:"",bracketOpen:"{",bracketClose:"}"}}),{c(){ge(t.$$.fragment)},m(e,r){be(t,e,r),n=!0},p(e,[n]){const r={};1&n&&(r.key=e[0]),2&n&&(r.isParentExpanded=e[1]),4&n&&(r.isParentArray=e[2]),16&n&&(r.keys=e[4]),24&n&&(r.label=e[3]+"("+e[4].length+")"),t.$set(r)},i(e){n||(fe(t.$$.fragment,e),n=!0)},o(e){ve(t.$$.fragment,e),n=!1},d(e){$e(t,e)}}}function Er(e){return e[0]}function Or(e){return e[1]}function Ir(e,t,n){let{key:r}=t,{value:a}=t,{isParentExpanded:o}=t,{isParentArray:s}=t,{nodeType:i}=t,l=[];return e.$set=e=>{"key"in e&&n(0,r=e.key),"value"in e&&n(5,a=e.value),"isParentExpanded"in e&&n(1,o=e.isParentExpanded),"isParentArray"in e&&n(2,s=e.isParentArray),"nodeType"in e&&n(3,i=e.nodeType)},e.$$.update=()=>{if(32&e.$$.dirty){let e=[],t=0;for(const n of a)e.push([t++,new Pr(n[0],n[1])]);n(4,l=e)}},[r,o,s,i,l,a]}class jr extends Pe{constructor(e){super(),we(this,e,Ir,kr,c,{key:0,value:5,isParentExpanded:1,isParentArray:2,nodeType:3})}}function Ar(e){let t,n;return t=new dr({props:{expanded:e[4],isParentExpanded:e[2],isParentArray:e[3],key:e[2]?String(e[0]):e[1].key,keys:e[5],getValue:e[6],label:e[2]?"Entry ":"=> ",bracketOpen:"{",bracketClose:"}"}}),{c(){ge(t.$$.fragment)},m(e,r){be(t,e,r),n=!0},p(e,[n]){const r={};16&n&&(r.expanded=e[4]),4&n&&(r.isParentExpanded=e[2]),8&n&&(r.isParentArray=e[3]),7&n&&(r.key=e[2]?String(e[0]):e[1].key),4&n&&(r.label=e[2]?"Entry ":"=> "),t.$set(r)},i(e){n||(fe(t.$$.fragment,e),n=!0)},o(e){ve(t.$$.fragment,e),n=!1},d(e){$e(t,e)}}}function _r(e,t,n){let{key:r}=t,{value:a}=t,{isParentExpanded:o}=t,{isParentArray:s}=t,{expanded:i=!1}=t;return e.$set=e=>{"key"in e&&n(0,r=e.key),"value"in e&&n(1,a=e.value),"isParentExpanded"in e&&n(2,o=e.isParentExpanded),"isParentArray"in e&&n(3,s=e.isParentArray),"expanded"in e&&n(4,i=e.expanded)},[r,a,o,s,i,["key","value"],function(e){return a[e]}]}class Dr extends Pe{constructor(e){super(),we(this,e,_r,Ar,c,{key:0,value:1,isParentExpanded:2,isParentArray:3,expanded:4})}}function Sr(e){let t,n,r,a,o,s,i,l=(e[2]?e[2](e[1]):e[1])+"";return n=new tr({props:{key:e[0],colon:e[6],isParentExpanded:e[3],isParentArray:e[4]}}),{c(){t=E("li"),ge(n.$$.fragment),r=j(),a=E("span"),o=I(l),D(a,"class",s=m(e[5])+" svelte-3bjyvl"),D(t,"class","svelte-3bjyvl"),T(t,"indent",e[3])},m(e,s){w(e,t,s),be(n,t,null),x(t,r),x(t,a),x(a,o),i=!0},p(e,[r]){const c={};1&r&&(c.key=e[0]),8&r&&(c.isParentExpanded=e[3]),16&r&&(c.isParentArray=e[4]),n.$set(c),(!i||6&r)&&l!==(l=(e[2]?e[2](e[1]):e[1])+"")&&S(o,l),(!i||32&r&&s!==(s=m(e[5])+" svelte-3bjyvl"))&&D(a,"class",s),8&r&&T(t,"indent",e[3])},i(e){i||(fe(n.$$.fragment,e),i=!0)},o(e){ve(n.$$.fragment,e),i=!1},d(e){e&&P(t),$e(n)}}}function Mr(e,t,n){let{key:r}=t,{value:a}=t,{valueGetter:o=null}=t,{isParentExpanded:s}=t,{isParentArray:i}=t,{nodeType:l}=t;const{colon:c}=W(Wn);return e.$set=e=>{"key"in e&&n(0,r=e.key),"value"in e&&n(1,a=e.value),"valueGetter"in e&&n(2,o=e.valueGetter),"isParentExpanded"in e&&n(3,s=e.isParentExpanded),"isParentArray"in e&&n(4,i=e.isParentArray),"nodeType"in e&&n(5,l=e.nodeType)},[r,a,o,s,i,l,c]}class Cr extends Pe{constructor(e){var t;super(),document.getElementById("svelte-3bjyvl-style")||((t=E("style")).id="svelte-3bjyvl-style",t.textContent="li.svelte-3bjyvl{user-select:text;word-wrap:break-word;word-break:break-all}.indent.svelte-3bjyvl{padding-left:var(--li-identation)}.String.svelte-3bjyvl{color:var(--string-color)}.Date.svelte-3bjyvl{color:var(--date-color)}.Number.svelte-3bjyvl{color:var(--number-color)}.Boolean.svelte-3bjyvl{color:var(--boolean-color)}.Null.svelte-3bjyvl{color:var(--null-color)}.Undefined.svelte-3bjyvl{color:var(--undefined-color)}.Function.svelte-3bjyvl{color:var(--function-color);font-style:italic}.Symbol.svelte-3bjyvl{color:var(--symbol-color)}",x(document.head,t)),we(this,e,Mr,Sr,c,{key:0,value:1,valueGetter:2,isParentExpanded:3,isParentArray:4,nodeType:5})}}function Nr(e,t,n){const r=e.slice();return r[8]=t[n],r[10]=n,r}function Tr(e){let t,n;return t=new Xn({props:{expanded:e[0]}}),t.$on("click",e[7]),{c(){ge(t.$$.fragment)},m(e,r){be(t,e,r),n=!0},p(e,n){const r={};1&n&&(r.expanded=e[0]),t.$set(r)},i(e){n||(fe(t.$$.fragment,e),n=!0)},o(e){ve(t.$$.fragment,e),n=!1},d(e){$e(t,e)}}}function zr(e){let t,n,r=e[0]&&Gr(e);return{c(){t=E("ul"),r&&r.c(),D(t,"class","svelte-1ca3gb2"),T(t,"collapse",!e[0])},m(e,a){w(e,t,a),r&&r.m(t,null),n=!0},p(e,n){e[0]?r?(r.p(e,n),1&n&&fe(r,1)):(r=Gr(e),r.c(),fe(r,1),r.m(t,null)):r&&(de(),ve(r,1,1,()=>{r=null}),pe()),1&n&&T(t,"collapse",!e[0])},i(e){n||(fe(r),n=!0)},o(e){ve(r),n=!1},d(e){e&&P(t),r&&r.d()}}}function Gr(e){let t,n,r,a,o,s,i;t=new Jr({props:{key:"message",value:e[2].message}}),a=new tr({props:{key:"stack",colon:":",isParentExpanded:e[3]}});let l=e[5],c=[];for(let t=0;t<l.length;t+=1)c[t]=qr(Nr(e,l,t));return{c(){ge(t.$$.fragment),n=j(),r=E("li"),ge(a.$$.fragment),o=j(),s=E("span");for(let e=0;e<c.length;e+=1)c[e].c();D(r,"class","svelte-1ca3gb2")},m(e,l){be(t,e,l),w(e,n,l),w(e,r,l),be(a,r,null),x(r,o),x(r,s);for(let e=0;e<c.length;e+=1)c[e].m(s,null);i=!0},p(e,n){const r={};4&n&&(r.value=e[2].message),t.$set(r);const o={};if(8&n&&(o.isParentExpanded=e[3]),a.$set(o),32&n){let t;for(l=e[5],t=0;t<l.length;t+=1){const r=Nr(e,l,t);c[t]?c[t].p(r,n):(c[t]=qr(r),c[t].c(),c[t].m(s,null))}for(;t<c.length;t+=1)c[t].d(1);c.length=l.length}},i(e){i||(fe(t.$$.fragment,e),fe(a.$$.fragment,e),i=!0)},o(e){ve(t.$$.fragment,e),ve(a.$$.fragment,e),i=!1},d(e){$e(t,e),e&&P(n),e&&P(r),$e(a),k(c,e)}}}function qr(e){let t,n,r,a=e[8]+"";return{c(){t=E("span"),n=I(a),r=E("br"),D(t,"class","svelte-1ca3gb2"),T(t,"indent",e[10]>0)},m(e,a){w(e,t,a),x(t,n),w(e,r,a)},p(e,t){32&t&&a!==(a=e[8]+"")&&S(n,a)},d(e){e&&P(t),e&&P(r)}}}function Br(e){let t,n,r,a,o,s,i,l,c,u,d,p=(e[0]?"":e[2].message)+"",f=e[3]&&Tr(e);r=new tr({props:{key:e[1],colon:e[6].colon,isParentExpanded:e[3],isParentArray:e[4]}});let v=e[3]&&zr(e);return{c(){t=E("li"),f&&f.c(),n=j(),ge(r.$$.fragment),a=j(),o=E("span"),s=I("Error: "),i=I(p),l=j(),v&&v.c(),D(t,"class","svelte-1ca3gb2"),T(t,"indent",e[3])},m(p,m){w(p,t,m),f&&f.m(t,null),x(t,n),be(r,t,null),x(t,a),x(t,o),x(o,s),x(o,i),x(t,l),v&&v.m(t,null),c=!0,u||(d=_(o,"click",e[7]),u=!0)},p(e,[a]){e[3]?f?(f.p(e,a),8&a&&fe(f,1)):(f=Tr(e),f.c(),fe(f,1),f.m(t,n)):f&&(de(),ve(f,1,1,()=>{f=null}),pe());const o={};2&a&&(o.key=e[1]),8&a&&(o.isParentExpanded=e[3]),16&a&&(o.isParentArray=e[4]),r.$set(o),(!c||5&a)&&p!==(p=(e[0]?"":e[2].message)+"")&&S(i,p),e[3]?v?(v.p(e,a),8&a&&fe(v,1)):(v=zr(e),v.c(),fe(v,1),v.m(t,null)):v&&(de(),ve(v,1,1,()=>{v=null}),pe()),8&a&&T(t,"indent",e[3])},i(e){c||(fe(f),fe(r.$$.fragment,e),fe(v),c=!0)},o(e){ve(f),ve(r.$$.fragment,e),ve(v),c=!1},d(e){e&&P(t),f&&f.d(),$e(r),v&&v.d(),u=!1,d()}}}function Lr(e,t,n){let{key:r}=t,{value:a}=t,{isParentExpanded:o}=t,{isParentArray:s}=t,{expanded:i=!1}=t;const l=W(Wn);let c;return F(Wn,{...l,colon:":"}),e.$set=e=>{"key"in e&&n(1,r=e.key),"value"in e&&n(2,a=e.value),"isParentExpanded"in e&&n(3,o=e.isParentExpanded),"isParentArray"in e&&n(4,s=e.isParentArray),"expanded"in e&&n(0,i=e.expanded)},e.$$.update=()=>{4&e.$$.dirty&&n(5,c=a.stack.split("\n")),8&e.$$.dirty&&(o||n(0,i=!1))},[i,r,a,o,s,c,l,function(){n(0,i=!i)}]}class Rr extends Pe{constructor(e){var t;super(),document.getElementById("svelte-1ca3gb2-style")||((t=E("style")).id="svelte-1ca3gb2-style",t.textContent="li.svelte-1ca3gb2{user-select:text;word-wrap:break-word;word-break:break-all}.indent.svelte-1ca3gb2{padding-left:var(--li-identation)}.collapse.svelte-1ca3gb2{--li-display:inline;display:inline;font-style:italic}",x(document.head,t)),we(this,e,Lr,Br,c,{key:1,value:2,isParentExpanded:3,isParentArray:4,expanded:0})}}function Ur(e){let t,n,r;var a=e[5];function o(e){return{props:{key:e[0],value:e[1],isParentExpanded:e[2],isParentArray:e[3],nodeType:e[4],valueGetter:e[6]}}}return a&&(t=new a(o(e))),{c(){t&&ge(t.$$.fragment),n=A()},m(e,a){t&&be(t,e,a),w(e,n,a),r=!0},p(e,[r]){const s={};if(1&r&&(s.key=e[0]),2&r&&(s.value=e[1]),4&r&&(s.isParentExpanded=e[2]),8&r&&(s.isParentArray=e[3]),16&r&&(s.nodeType=e[4]),64&r&&(s.valueGetter=e[6]),a!==(a=e[5])){if(t){de();const e=t;ve(e.$$.fragment,1,0,()=>{$e(e,1)}),pe()}a?(t=new a(o(e)),ge(t.$$.fragment),fe(t.$$.fragment,1),be(t,n.parentNode,n)):t=null}else a&&t.$set(s)},i(e){r||(t&&fe(t.$$.fragment,e),r=!0)},o(e){t&&ve(t.$$.fragment,e),r=!1},d(e){e&&P(n),t&&$e(t,e)}}}function Vr(e,t,n){let r,a,o,{key:s}=t,{value:i}=t,{isParentExpanded:l}=t,{isParentArray:c}=t;return e.$set=e=>{"key"in e&&n(0,s=e.key),"value"in e&&n(1,i=e.value),"isParentExpanded"in e&&n(2,l=e.isParentExpanded),"isParentArray"in e&&n(3,c=e.isParentArray)},e.$$.update=()=>{2&e.$$.dirty&&n(4,r=function(e){const t=Object.prototype.toString.call(e).slice(8,-1);return"Object"===t?"function"==typeof e[Symbol.iterator]?"Iterable":e.constructor.name:t}(i)),16&e.$$.dirty&&n(5,a=function(e){switch(e){case"Object":return vr;case"Error":return Rr;case"Array":return hr;case"Iterable":case"Map":case"Set":return"function"==typeof i.set?jr:wr;case"MapEntry":return Dr;default:return Cr}}(r)),16&e.$$.dirty&&n(6,o=function(e){switch(e){case"Object":case"Error":case"Array":case"Iterable":case"Map":case"Set":case"MapEntry":case"Number":return;case"String":return e=>`"${e}"`;case"Boolean":return e=>e?"true":"false";case"Date":return e=>e.toISOString();case"Null":return()=>"null";case"Undefined":return()=>"undefined";case"Function":case"Symbol":return e=>e.toString();default:return()=>`<${e}>`}}(r))},[s,i,l,c,r,a,o]}class Jr extends Pe{constructor(e){super(),we(this,e,Vr,Ur,c,{key:0,value:1,isParentExpanded:2,isParentArray:3})}}function Kr(e){let t,n,r;return n=new Jr({props:{key:e[0],value:e[1],isParentExpanded:!0,isParentArray:!1}}),{c(){t=E("ul"),ge(n.$$.fragment),D(t,"class","svelte-773n60")},m(e,a){w(e,t,a),be(n,t,null),r=!0},p(e,[t]){const r={};1&t&&(r.key=e[0]),2&t&&(r.value=e[1]),n.$set(r)},i(e){r||(fe(n.$$.fragment,e),r=!0)},o(e){ve(n.$$.fragment,e),r=!1},d(e){e&&P(t),$e(n)}}}function Fr(e,t,n){F(Wn,{});let{key:r=""}=t,{value:a}=t;return e.$set=e=>{"key"in e&&n(0,r=e.key),"value"in e&&n(1,a=e.value)},[r,a]}class Wr extends Pe{constructor(e){var t;super(),document.getElementById("svelte-773n60-style")||((t=E("style")).id="svelte-773n60-style",t.textContent="ul.svelte-773n60{--string-color:var(--json-tree-string-color, #cb3f41);--symbol-color:var(--json-tree-symbol-color, #cb3f41);--boolean-color:var(--json-tree-boolean-color, #112aa7);--function-color:var(--json-tree-function-color, #112aa7);--number-color:var(--json-tree-number-color, #3029cf);--label-color:var(--json-tree-label-color, #871d8f);--arrow-color:var(--json-tree-arrow-color, #727272);--null-color:var(--json-tree-null-color, #8d8d8d);--undefined-color:var(--json-tree-undefined-color, #8d8d8d);--date-color:var(--json-tree-date-color, #8d8d8d);--li-identation:var(--json-tree-li-indentation, 1em);--li-line-height:var(--json-tree-li-line-height, 1.3);--li-colon-space:0.3em;font-size:var(--json-tree-font-size, 12px);font-family:var(--json-tree-font-family, 'Courier New', Courier, monospace)}ul.svelte-773n60 li{line-height:var(--li-line-height);display:var(--li-display, list-item);list-style:none}ul.svelte-773n60,ul.svelte-773n60 ul{padding:0;margin:0}",x(document.head,t)),we(this,e,Fr,Kr,c,{key:0,value:1})}}const{document:Hr}=he;function Yr(e,t,n){const r=e.slice();return r[7]=t[n],r[9]=n,r}function Xr(e){let t,n,r,a,o,s,l=e[1],c=[];for(let t=0;t<l.length;t+=1)c[t]=Zr(Yr(e,l,t));return{c(){t=E("section"),n=E("label"),r=I("Client\n      \n      "),a=E("select");for(let e=0;e<c.length;e+=1)c[e].c();D(a,"id",ea),D(a,"class","svelte-jvfq3i"),void 0===e[2]&&ne(()=>e[4].call(a)),D(n,"class","svelte-jvfq3i"),D(t,"class","switcher svelte-jvfq3i")},m(i,l){w(i,t,l),x(t,n),x(n,r),x(n,a);for(let e=0;e<c.length;e+=1)c[e].m(a,null);C(a,e[2]),o||(s=[_(a,"change",e[3]),_(a,"change",e[4])],o=!0)},p(e,t){if(2&t){let n;for(l=e[1],n=0;n<l.length;n+=1){const r=Yr(e,l,n);c[n]?c[n].p(r,t):(c[n]=Zr(r),c[n].c(),c[n].m(a,null))}for(;n<c.length;n+=1)c[n].d(1);c.length=l.length}4&t&&C(a,e[2])},d(e){e&&P(t),k(c,e),o=!1,i(s)}}}function Zr(e){let t,n,r,a,o,s,i,l,c,u,d=JSON.stringify(e[7].playerID)+"",p=JSON.stringify(e[7].matchID)+"",f=e[7].game.name+"";return{c(){t=E("option"),n=I(e[9]),r=I(" —\n            playerID: "),a=I(d),o=I(",\n            matchID: "),s=I(p),i=I("\n            ("),l=I(f),c=I(")\n          "),t.__value=u=e[9],t.value=t.__value,D(t,"class","svelte-jvfq3i")},m(e,u){w(e,t,u),x(t,n),x(t,r),x(t,a),x(t,o),x(t,s),x(t,i),x(t,l),x(t,c)},p(e,t){2&t&&d!==(d=JSON.stringify(e[7].playerID)+"")&&S(a,d),2&t&&p!==(p=JSON.stringify(e[7].matchID)+"")&&S(s,p),2&t&&f!==(f=e[7].game.name+"")&&S(l,f)},d(e){e&&P(t)}}}function Qr(e){let t,r=e[1].length>1&&Xr(e);return{c(){r&&r.c(),t=A()},m(e,n){r&&r.m(e,n),w(e,t,n)},p(e,[n]){e[1].length>1?r?r.p(e,n):(r=Xr(e),r.c(),r.m(t.parentNode,t)):r&&(r.d(1),r=null)},i:n,o:n,d(e){r&&r.d(e),e&&P(t)}}}const ea="bgio-debug-select-client";function ta(e,t,r){let a,o=n,s=()=>(o(),o=u(i,e=>r(6,a=e)),i);e.$$.on_destroy.push(()=>o());let{clientManager:i}=t;s();let l,c,d;return e.$set=e=>{"clientManager"in e&&s(r(0,i=e.clientManager))},e.$$.update=()=>{64&e.$$.dirty&&r(5,({client:l,debuggableClients:c}=a),l,(r(1,c),r(6,a))),34&e.$$.dirty&&r(2,d=c.indexOf(l))},[i,c,d,e=>{const t=c[e.target.value];i.switchToClient(t);const n=document.getElementById(ea);n&&n.focus()},function(){d=N(this),r(2,d),r(1,c),r(5,l),r(6,a)}]}class na extends Pe{constructor(e){var t;super(),Hr.getElementById("svelte-jvfq3i-style")||((t=E("style")).id="svelte-jvfq3i-style",t.textContent=".svelte-jvfq3i{box-sizing:border-box}section.switcher.svelte-jvfq3i{position:sticky;bottom:0;transform:translateY(20px);margin:40px -20px 0;border-top:1px solid #999;padding:20px;background:#fff}label.svelte-jvfq3i{display:flex;align-items:baseline;gap:5px;font-weight:bold}select.svelte-jvfq3i{min-width:140px}",x(Hr.head,t)),we(this,e,ta,Qr,c,{clientManager:0})}}function ra(e){let t,n,r,a,o,s=`(shortcut: ${e[0]})`+"";return{c(){t=E("label"),n=I(e[1]),r=j(),a=E("span"),o=I(s),D(a,"class","screen-reader-only"),D(t,"for",e[5]),D(t,"class","svelte-1vfj1mn")},m(e,s){w(e,t,s),x(t,n),x(t,r),x(t,a),x(a,o)},p(e,t){2&t&&S(n,e[1]),1&t&&s!==(s=`(shortcut: ${e[0]})`+"")&&S(o,s)},d(e){e&&P(t)}}}function aa(e){let t,r,a,o,s,l,c=e[1]&&ra(e);return{c(){t=E("div"),r=E("button"),a=I(e[0]),o=j(),c&&c.c(),D(r,"id",e[5]),r.disabled=e[2],D(r,"class","svelte-1vfj1mn"),D(t,"class","key svelte-1vfj1mn"),T(t,"active",e[3])},m(n,i){w(n,t,i),x(t,r),x(r,a),x(t,o),c&&c.m(t,null),s||(l=[_(window,"keydown",e[7]),_(r,"click",e[6])],s=!0)},p(e,[n]){1&n&&S(a,e[0]),4&n&&(r.disabled=e[2]),e[1]?c?c.p(e,n):(c=ra(e),c.c(),c.m(t,null)):c&&(c.d(1),c=null),8&n&&T(t,"active",e[3])},i:n,o:n,d(e){e&&P(t),c&&c.d(),s=!1,i(l)}}}function oa(e,t,n){let r,{value:a}=t,{onPress:o=null}=t,{label:s=null}=t,{disable:i=!1}=t;const{disableHotkeys:l}=W("hotkeys");d(e,l,e=>n(9,r=e));let c=!1,u=`key-${a}`;function p(){n(3,c=!1)}function f(){n(3,c=!0),setTimeout(p,200),o&&setTimeout(o,1)}return e.$set=e=>{"value"in e&&n(0,a=e.value),"onPress"in e&&n(8,o=e.onPress),"label"in e&&n(1,s=e.label),"disable"in e&&n(2,i=e.disable)},[a,s,i,c,l,u,f,function(e){r||i||e.ctrlKey||e.metaKey||e.key!=a||(e.preventDefault(),f())},o]}class sa extends Pe{constructor(e){var t;super(),document.getElementById("svelte-1vfj1mn-style")||((t=E("style")).id="svelte-1vfj1mn-style",t.textContent=".key.svelte-1vfj1mn.svelte-1vfj1mn{display:flex;flex-direction:row;align-items:center}button.svelte-1vfj1mn.svelte-1vfj1mn{cursor:pointer;min-width:10px;padding-left:5px;padding-right:5px;height:20px;line-height:20px;text-align:center;border:1px solid #ccc;box-shadow:1px 1px 1px #888;background:#eee;color:#444}button.svelte-1vfj1mn.svelte-1vfj1mn:hover{background:#ddd}.key.active.svelte-1vfj1mn button.svelte-1vfj1mn{background:#ddd;border:1px solid #999;box-shadow:none}label.svelte-1vfj1mn.svelte-1vfj1mn{margin-left:10px}",x(document.head,t)),we(this,e,oa,aa,c,{value:0,onPress:8,label:1,disable:2})}}function ia(e){let t,r,a,o,s,c,u,d,p,f,v;return{c(){t=E("div"),r=E("span"),a=I(e[2]),o=j(),s=E("span"),s.textContent="(",c=j(),u=E("span"),d=j(),p=E("span"),p.textContent=")",D(u,"class","arg-field svelte-1mppqmp"),D(u,"contenteditable",""),D(t,"class","move svelte-1mppqmp"),T(t,"active",e[3])},m(n,i){var m;w(n,t,i),x(t,r),x(r,a),x(t,o),x(t,s),x(t,c),x(t,u),e[6](u),x(t,d),x(t,p),f||(v=[_(u,"focus",(function(){l(e[0])&&e[0].apply(this,arguments)})),_(u,"blur",(function(){l(e[1])&&e[1].apply(this,arguments)})),_(u,"keypress",(m=la,function(e){return e.stopPropagation(),m.call(this,e)})),_(u,"keydown",e[5]),_(t,"click",(function(){l(e[0])&&e[0].apply(this,arguments)}))],f=!0)},p(n,[r]){e=n,4&r&&S(a,e[2]),8&r&&T(t,"active",e[3])},i:n,o:n,d(n){n&&P(t),e[6](null),f=!1,i(v)}}}const la=()=>{};function ca(e,t,n){let r,{Activate:a}=t,{Deactivate:o}=t,{name:s}=t,{active:i}=t;const l=K();var c;return c=()=>{i?r.focus():r.blur()},V().$$.after_update.push(c),e.$set=e=>{"Activate"in e&&n(0,a=e.Activate),"Deactivate"in e&&n(1,o=e.Deactivate),"name"in e&&n(2,s=e.name),"active"in e&&n(3,i=e.active)},[a,o,s,i,r,function(e){"Enter"==e.key&&(e.preventDefault(),function(){try{const e=r.innerText;let t=new Function(`return [${e}]`)();l("submit",t)}catch(e){l("error",e)}n(4,r.innerText="",r)}()),"Escape"==e.key&&(e.preventDefault(),o())},function(e){X[e?"unshift":"push"](()=>{r=e,n(4,r)})}]}class ua extends Pe{constructor(e){var t;super(),document.getElementById("svelte-1mppqmp-style")||((t=E("style")).id="svelte-1mppqmp-style",t.textContent=".move.svelte-1mppqmp{display:flex;flex-direction:row;cursor:pointer;margin-left:10px;color:#666}.move.svelte-1mppqmp:hover{color:#333}.move.active.svelte-1mppqmp{color:#111;font-weight:bold}.arg-field.svelte-1mppqmp{outline:none;font-family:monospace}",x(document.head,t)),we(this,e,ca,ia,c,{Activate:0,Deactivate:1,name:2,active:3})}}function da(e){let t,n;return{c(){t=E("span"),n=I(e[2]),D(t,"class","move-error svelte-smqssc")},m(e,r){w(e,t,r),x(t,n)},p(e,t){4&t&&S(n,e[2])},d(e){e&&P(t)}}}function pa(e){let t,n,r,a,o,s,i;r=new sa({props:{value:e[0],onPress:e[4]}}),o=new ua({props:{Activate:e[4],Deactivate:e[5],name:e[1],active:e[3]}}),o.$on("submit",e[6]),o.$on("error",e[7]);let l=e[2]&&da(e);return{c(){t=E("div"),n=E("div"),ge(r.$$.fragment),a=j(),ge(o.$$.fragment),s=j(),l&&l.c(),D(n,"class","wrapper svelte-smqssc")},m(e,c){w(e,t,c),x(t,n),be(r,n,null),x(n,a),be(o,n,null),x(t,s),l&&l.m(t,null),i=!0},p(e,[n]){const a={};1&n&&(a.value=e[0]),r.$set(a);const s={};2&n&&(s.name=e[1]),8&n&&(s.active=e[3]),o.$set(s),e[2]?l?l.p(e,n):(l=da(e),l.c(),l.m(t,null)):l&&(l.d(1),l=null)},i(e){i||(fe(r.$$.fragment,e),fe(o.$$.fragment,e),i=!0)},o(e){ve(r.$$.fragment,e),ve(o.$$.fragment,e),i=!1},d(e){e&&P(t),$e(r),$e(o),l&&l.d()}}}function fa(e,t,n){let{shortcut:r}=t,{name:a}=t,{fn:o}=t;const{disableHotkeys:s}=W("hotkeys");let i="",l=!1;function c(){s.set(!1),n(2,i=""),n(3,l=!1)}return e.$set=e=>{"shortcut"in e&&n(0,r=e.shortcut),"name"in e&&n(1,a=e.name),"fn"in e&&n(8,o=e.fn)},[r,a,i,l,function(){s.set(!0),n(3,l=!0)},c,function(e){n(2,i=""),c(),o.apply(this,e.detail)},function(e){n(2,i=e.detail),cn(e.detail)},o]}class va extends Pe{constructor(e){var t;super(),document.getElementById("svelte-smqssc-style")||((t=E("style")).id="svelte-smqssc-style",t.textContent=".move-error.svelte-smqssc{color:#a00;font-weight:bold}.wrapper.svelte-smqssc{display:flex;flex-direction:row;align-items:center}",x(document.head,t)),we(this,e,fa,pa,c,{shortcut:0,name:1,fn:8})}}var ma=function(e,t){return{parse:function(t){var n=JSON.parse(t,a).map(r),o=n[0];return"object"==typeof o&&o?function t(n,r,a){return Object.keys(a).reduce((function(a,o){var s=a[o];if(s instanceof e){var i=n[s];"object"!=typeof i||r.has(i)?a[o]=i:(r.add(i),a[o]=t(n,r,i))}return a}),a)}(n,new Set,o):o},stringify:function(e){for(var t,r=new Map,a=[],o=[],s=+n(r,a,e),i=function(e,o){if(t)return t=!t,o;switch(typeof o){case"object":if(null===o)return o;case"string":return r.get(o)||n(r,a,o)}return o};s<a.length;s++)t=!0,o[s]=JSON.stringify(a[s],i);return"["+o.join(",")+"]"}};function n(t,n,r){var a=e(n.push(r)-1);return t.set(r,a),a}function r(t){return t instanceof e?e(t):t}function a(t,n){return"string"==typeof n?new e(n):n}}(String);const ya=ma.parse,ha=ma.stringify;function ga(e){let t,n,r,a,o,s,i,l,c,u,d,p,f;return r=new sa({props:{value:"1",onPress:e[0].reset,label:"reset"}}),s=new sa({props:{value:"2",onPress:e[1],label:"save"}}),c=new sa({props:{value:"3",onPress:e[2],label:"restore"}}),p=new sa({props:{value:".",disable:!0,label:"hide"}}),{c(){t=E("ul"),n=E("li"),ge(r.$$.fragment),a=j(),o=E("li"),ge(s.$$.fragment),i=j(),l=E("li"),ge(c.$$.fragment),u=j(),d=E("li"),ge(p.$$.fragment),D(n,"class","svelte-c3lavh"),D(o,"class","svelte-c3lavh"),D(l,"class","svelte-c3lavh"),D(d,"class","svelte-c3lavh"),D(t,"id","debug-controls"),D(t,"class","controls svelte-c3lavh")},m(e,v){w(e,t,v),x(t,n),be(r,n,null),x(t,a),x(t,o),be(s,o,null),x(t,i),x(t,l),be(c,l,null),x(t,u),x(t,d),be(p,d,null),f=!0},p(e,[t]){const n={};1&t&&(n.onPress=e[0].reset),r.$set(n)},i(e){f||(fe(r.$$.fragment,e),fe(s.$$.fragment,e),fe(c.$$.fragment,e),fe(p.$$.fragment,e),f=!0)},o(e){ve(r.$$.fragment,e),ve(s.$$.fragment,e),ve(c.$$.fragment,e),ve(p.$$.fragment,e),f=!1},d(e){e&&P(t),$e(r),$e(s),$e(c),$e(p)}}}function ba(e,t,n){let{client:r}=t;return e.$set=e=>{"client"in e&&n(0,r=e.client)},[r,function(){const e=r.getState(),t=ha({...e,_undo:[],_redo:[],deltalog:[]});window.localStorage.setItem("gamestate",t),window.localStorage.setItem("initialState",ha(r.initialState))},function(){const e=window.localStorage.getItem("gamestate"),t=window.localStorage.getItem("initialState");if(null!==e&&null!==t){const n=ya(e),a=ya(t);r.store.dispatch(Te({state:n,initialState:a}))}}]}class $a extends Pe{constructor(e){var t;super(),document.getElementById("svelte-c3lavh-style")||((t=E("style")).id="svelte-c3lavh-style",t.textContent="ul.svelte-c3lavh{padding-left:0}li.svelte-c3lavh{list-style:none;margin:none;margin-bottom:5px}",x(document.head,t)),we(this,e,ba,ga,c,{client:0})}}function xa(e,t,n){const r=e.slice();return r[7]=t[n],r}function wa(e){let t,n,r,a,o,s,i=e[7]+"";function l(...t){return e[5](e[7],...t)}return{c(){t=E("button"),n=I(i),r=j(),D(t,"class","player svelte-19aan9p"),D(t,"aria-label",a=e[4](e[7])),T(t,"current",e[7]==e[0].currentPlayer),T(t,"active",e[7]==e[1])},m(e,a){w(e,t,a),x(t,n),x(t,r),o||(s=_(t,"click",l),o=!0)},p(r,o){e=r,4&o&&i!==(i=e[7]+"")&&S(n,i),4&o&&a!==(a=e[4](e[7]))&&D(t,"aria-label",a),5&o&&T(t,"current",e[7]==e[0].currentPlayer),6&o&&T(t,"active",e[7]==e[1])},d(e){e&&P(t),o=!1,s()}}}function Pa(e){let t,r=e[2],a=[];for(let t=0;t<r.length;t+=1)a[t]=wa(xa(e,r,t));return{c(){t=E("div");for(let e=0;e<a.length;e+=1)a[e].c();D(t,"class","player-box svelte-19aan9p")},m(e,n){w(e,t,n);for(let e=0;e<a.length;e+=1)a[e].m(t,null)},p(e,[n]){if(31&n){let o;for(r=e[2],o=0;o<r.length;o+=1){const s=xa(e,r,o);a[o]?a[o].p(s,n):(a[o]=wa(s),a[o].c(),a[o].m(t,null))}for(;o<a.length;o+=1)a[o].d(1);a.length=r.length}},i:n,o:n,d(e){e&&P(t),k(a,e)}}}function ka(e,t,n){let{ctx:r}=t,{playerID:a}=t;const o=K();function s(e){o("change",e==a?{playerID:null}:{playerID:e})}let i;return e.$set=e=>{"ctx"in e&&n(0,r=e.ctx),"playerID"in e&&n(1,a=e.playerID)},e.$$.update=()=>{1&e.$$.dirty&&n(2,i=r?[...Array(r.numPlayers).keys()].map(e=>e.toString()):[])},[r,a,i,s,function(e){const t=[];e==r.currentPlayer&&t.push("current"),e==a&&t.push("active");let n=`Player ${e}`;return t.length&&(n+=` (${t.join(", ")})`),n},e=>s(e)]}class Ea extends Pe{constructor(e){var t;super(),document.getElementById("svelte-19aan9p-style")||((t=E("style")).id="svelte-19aan9p-style",t.textContent=".player-box.svelte-19aan9p{display:flex;flex-direction:row}.player.svelte-19aan9p{cursor:pointer;text-align:center;width:30px;height:30px;line-height:30px;background:#eee;border:3px solid #fefefe;box-sizing:content-box;padding:0}.player.current.svelte-19aan9p{background:#555;color:#eee;font-weight:bold}.player.active.svelte-19aan9p{border:3px solid #ff7f50}",x(document.head,t)),we(this,e,ka,Pa,c,{ctx:0,playerID:1})}}function Oa(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function Ia(e,t){var n;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return Oa(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Oa(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length){n&&(e=n);var r=0,a=function(){};return{s:a,n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:a}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,s=!0,i=!1;return{s:function(){n=e[Symbol.iterator]()},n:function(){var e=n.next();return s=e.done,e},e:function(e){i=!0,o=e},f:function(){try{s||null==n.return||n.return()}finally{if(i)throw o}}}}function ja(e,t,n){const r=e.slice();return r[9]=t[n][0],r[10]=t[n][1],r}function Aa(e){let t,n,r,a;return n=new va({props:{shortcut:e[7][e[9]],fn:e[10],name:e[9]}}),{c(){t=E("li"),ge(n.$$.fragment),r=j(),D(t,"class","svelte-146sq5f")},m(e,o){w(e,t,o),be(n,t,null),x(t,r),a=!0},p(e,t){const r={};8&t&&(r.shortcut=e[7][e[9]]),8&t&&(r.fn=e[10]),8&t&&(r.name=e[9]),n.$set(r)},i(e){a||(fe(n.$$.fragment,e),a=!0)},o(e){ve(n.$$.fragment,e),a=!1},d(e){e&&P(t),$e(n)}}}function _a(e){let t,n,r;return n=new va({props:{name:"endStage",shortcut:7,fn:e[4].endStage}}),{c(){t=E("li"),ge(n.$$.fragment),D(t,"class","svelte-146sq5f")},m(e,a){w(e,t,a),be(n,t,null),r=!0},p(e,t){const r={};16&t&&(r.fn=e[4].endStage),n.$set(r)},i(e){r||(fe(n.$$.fragment,e),r=!0)},o(e){ve(n.$$.fragment,e),r=!1},d(e){e&&P(t),$e(n)}}}function Da(e){let t,n,r;return n=new va({props:{name:"endTurn",shortcut:8,fn:e[4].endTurn}}),{c(){t=E("li"),ge(n.$$.fragment),D(t,"class","svelte-146sq5f")},m(e,a){w(e,t,a),be(n,t,null),r=!0},p(e,t){const r={};16&t&&(r.fn=e[4].endTurn),n.$set(r)},i(e){r||(fe(n.$$.fragment,e),r=!0)},o(e){ve(n.$$.fragment,e),r=!1},d(e){e&&P(t),$e(n)}}}function Sa(e){let t,n,r;return n=new va({props:{name:"endPhase",shortcut:9,fn:e[4].endPhase}}),{c(){t=E("li"),ge(n.$$.fragment),D(t,"class","svelte-146sq5f")},m(e,a){w(e,t,a),be(n,t,null),r=!0},p(e,t){const r={};16&t&&(r.fn=e[4].endPhase),n.$set(r)},i(e){r||(fe(n.$$.fragment,e),r=!0)},o(e){ve(n.$$.fragment,e),r=!1},d(e){e&&P(t),$e(n)}}}function Ma(e){let t,n,r,a,o,s,i,l,c,u,d,p,f,v,m,y,h,g,b,$,O,I,A,_,S,M,C,N,T,z,G,q,B,L;a=new $a({props:{client:e[0]}}),c=new Ea({props:{ctx:e[5],playerID:e[2]}}),c.$on("change",e[8]);let R=Object.entries(e[3]),U=[];for(let t=0;t<R.length;t+=1)U[t]=Aa(ja(e,R,t));const V=e=>ve(U[e],1,1,()=>{U[e]=null});let J=e[5].activePlayers&&e[4].endStage&&_a(e),K=e[4].endTurn&&Da(e),F=e[5].phase&&e[4].endPhase&&Sa(e);return M=new Wr({props:{value:e[6]}}),G=new Wr({props:{value:Ca(e[5])}}),B=new na({props:{clientManager:e[1]}}),{c(){t=E("section"),n=E("h3"),n.textContent="Controls",r=j(),ge(a.$$.fragment),o=j(),s=E("section"),i=E("h3"),i.textContent="Players",l=j(),ge(c.$$.fragment),u=j(),d=E("section"),p=E("h3"),p.textContent="Moves",f=j(),v=E("ul");for(let e=0;e<U.length;e+=1)U[e].c();m=j(),y=E("section"),h=E("h3"),h.textContent="Events",g=j(),b=E("ul"),J&&J.c(),$=j(),K&&K.c(),O=j(),F&&F.c(),I=j(),A=E("section"),_=E("h3"),_.textContent="G",S=j(),ge(M.$$.fragment),C=j(),N=E("section"),T=E("h3"),T.textContent="ctx",z=j(),ge(G.$$.fragment),q=j(),ge(B.$$.fragment),D(n,"class","svelte-146sq5f"),D(i,"class","svelte-146sq5f"),D(p,"class","svelte-146sq5f"),D(v,"class","svelte-146sq5f"),D(h,"class","svelte-146sq5f"),D(b,"class","svelte-146sq5f"),D(_,"class","label svelte-146sq5f"),D(A,"class","tree svelte-146sq5f"),D(T,"class","label svelte-146sq5f"),D(N,"class","tree svelte-146sq5f")},m(e,P){w(e,t,P),x(t,n),x(t,r),be(a,t,null),w(e,o,P),w(e,s,P),x(s,i),x(s,l),be(c,s,null),w(e,u,P),w(e,d,P),x(d,p),x(d,f),x(d,v);for(let e=0;e<U.length;e+=1)U[e].m(v,null);w(e,m,P),w(e,y,P),x(y,h),x(y,g),x(y,b),J&&J.m(b,null),x(b,$),K&&K.m(b,null),x(b,O),F&&F.m(b,null),w(e,I,P),w(e,A,P),x(A,_),x(A,S),be(M,A,null),w(e,C,P),w(e,N,P),x(N,T),x(N,z),be(G,N,null),w(e,q,P),be(B,e,P),L=!0},p(e,[t]){const n={};1&t&&(n.client=e[0]),a.$set(n);const r={};if(32&t&&(r.ctx=e[5]),4&t&&(r.playerID=e[2]),c.$set(r),136&t){let n;for(R=Object.entries(e[3]),n=0;n<R.length;n+=1){const r=ja(e,R,n);U[n]?(U[n].p(r,t),fe(U[n],1)):(U[n]=Aa(r),U[n].c(),fe(U[n],1),U[n].m(v,null))}for(de(),n=R.length;n<U.length;n+=1)V(n);pe()}e[5].activePlayers&&e[4].endStage?J?(J.p(e,t),48&t&&fe(J,1)):(J=_a(e),J.c(),fe(J,1),J.m(b,$)):J&&(de(),ve(J,1,1,()=>{J=null}),pe()),e[4].endTurn?K?(K.p(e,t),16&t&&fe(K,1)):(K=Da(e),K.c(),fe(K,1),K.m(b,O)):K&&(de(),ve(K,1,1,()=>{K=null}),pe()),e[5].phase&&e[4].endPhase?F?(F.p(e,t),48&t&&fe(F,1)):(F=Sa(e),F.c(),fe(F,1),F.m(b,null)):F&&(de(),ve(F,1,1,()=>{F=null}),pe());const o={};64&t&&(o.value=e[6]),M.$set(o);const s={};32&t&&(s.value=Ca(e[5])),G.$set(s);const i={};2&t&&(i.clientManager=e[1]),B.$set(i)},i(e){if(!L){fe(a.$$.fragment,e),fe(c.$$.fragment,e);for(let e=0;e<R.length;e+=1)fe(U[e]);fe(J),fe(K),fe(F),fe(M.$$.fragment,e),fe(G.$$.fragment,e),fe(B.$$.fragment,e),L=!0}},o(e){ve(a.$$.fragment,e),ve(c.$$.fragment,e),U=U.filter(Boolean);for(let e=0;e<U.length;e+=1)ve(U[e]);ve(J),ve(K),ve(F),ve(M.$$.fragment,e),ve(G.$$.fragment,e),ve(B.$$.fragment,e),L=!1},d(e){e&&P(t),$e(a),e&&P(o),e&&P(s),$e(c),e&&P(u),e&&P(d),k(U,e),e&&P(m),e&&P(y),J&&J.d(),K&&K.d(),F&&F.d(),e&&P(I),e&&P(A),$e(M),e&&P(C),e&&P(N),$e(G),e&&P(q),$e(B,e)}}}function Ca(e){let t={};for(const n in e)n.startsWith("_")||(t[n]=e[n]);return t}function Na(e,t,n){let{client:r}=t,{clientManager:a}=t;const o=function(e,t){var n,r={},a={},o=Ia(t);try{for(o.s();!(n=o.n()).done;){a[n.value]=!0}}catch(e){o.e(e)}finally{o.f()}var s=a,i=!0;for(var l in e){var c=l[0];if(s[c]){i=!1;break}s[c]=!0,r[l]=c}if(i)return r;s=a;var u=97;for(var d in r={},e){for(var p=String.fromCharCode(u);s[p];)u++,p=String.fromCharCode(u);s[p]=!0,r[d]=p}return r}(r.moves,"mlia");let{playerID:s,moves:i,events:l}=r,c={},u={};r.subscribe(e=>{e&&n(6,({G:u,ctx:c}=e),u,n(5,c)),n(2,({playerID:s,moves:i,events:l}=r),s,n(3,i),n(4,l))});return e.$set=e=>{"client"in e&&n(0,r=e.client),"clientManager"in e&&n(1,a=e.clientManager)},[r,a,s,i,l,c,u,o,e=>a.switchPlayerID(e.detail.playerID)]}class Ta extends Pe{constructor(e){var t;super(),document.getElementById("svelte-146sq5f-style")||((t=E("style")).id="svelte-146sq5f-style",t.textContent=".tree.svelte-146sq5f{--json-tree-font-family:monospace;--json-tree-font-size:14px;--json-tree-null-color:#757575}.label.svelte-146sq5f{margin-bottom:0;text-transform:none}h3.svelte-146sq5f{text-transform:uppercase}ul.svelte-146sq5f{padding-left:0}li.svelte-146sq5f{list-style:none;margin:0;margin-bottom:5px}",x(document.head,t)),we(this,e,Na,Ma,c,{client:0,clientManager:1})}}function za(e){let t,r,a,o,s,i,l=JSON.stringify(e[1])+"";return{c(){t=E("div"),r=E("strong"),a=I(e[0]),o=j(),s=E("div"),i=I(l),D(s,"class","svelte-13qih23"),D(t,"class","item svelte-13qih23")},m(e,n){w(e,t,n),x(t,r),x(r,a),x(t,o),x(t,s),x(s,i)},p(e,[t]){1&t&&S(a,e[0]),2&t&&l!==(l=JSON.stringify(e[1])+"")&&S(i,l)},i:n,o:n,d(e){e&&P(t)}}}function Ga(e,t,n){let{name:r}=t,{value:a}=t;return e.$set=e=>{"name"in e&&n(0,r=e.name),"value"in e&&n(1,a=e.value)},[r,a]}class qa extends Pe{constructor(e){var t;super(),document.getElementById("svelte-13qih23-style")||((t=E("style")).id="svelte-13qih23-style",t.textContent=".item.svelte-13qih23.svelte-13qih23{padding:10px}.item.svelte-13qih23.svelte-13qih23:not(:first-child){border-top:1px dashed #aaa}.item.svelte-13qih23 div.svelte-13qih23{float:right;text-align:right}",x(document.head,t)),we(this,e,Ga,za,c,{name:0,value:1})}}function Ba(e){let t,n;return t=new qa({props:{name:"isConnected",value:e[1].isConnected}}),{c(){ge(t.$$.fragment)},m(e,r){be(t,e,r),n=!0},p(e,n){const r={};2&n&&(r.value=e[1].isConnected),t.$set(r)},i(e){n||(fe(t.$$.fragment,e),n=!0)},o(e){ve(t.$$.fragment,e),n=!1},d(e){$e(t,e)}}}function La(e){let t,n,r,a,o,s,i,l;n=new qa({props:{name:"matchID",value:e[0].matchID}}),a=new qa({props:{name:"playerID",value:e[0].playerID}}),s=new qa({props:{name:"isActive",value:e[1].isActive}});let c=e[0].multiplayer&&Ba(e);return{c(){t=E("section"),ge(n.$$.fragment),r=j(),ge(a.$$.fragment),o=j(),ge(s.$$.fragment),i=j(),c&&c.c(),D(t,"class","gameinfo svelte-1yzq5o8")},m(e,u){w(e,t,u),be(n,t,null),x(t,r),be(a,t,null),x(t,o),be(s,t,null),x(t,i),c&&c.m(t,null),l=!0},p(e,[r]){const o={};1&r&&(o.value=e[0].matchID),n.$set(o);const i={};1&r&&(i.value=e[0].playerID),a.$set(i);const l={};2&r&&(l.value=e[1].isActive),s.$set(l),e[0].multiplayer?c?(c.p(e,r),1&r&&fe(c,1)):(c=Ba(e),c.c(),fe(c,1),c.m(t,null)):c&&(de(),ve(c,1,1,()=>{c=null}),pe())},i(e){l||(fe(n.$$.fragment,e),fe(a.$$.fragment,e),fe(s.$$.fragment,e),fe(c),l=!0)},o(e){ve(n.$$.fragment,e),ve(a.$$.fragment,e),ve(s.$$.fragment,e),ve(c),l=!1},d(e){e&&P(t),$e(n),$e(a),$e(s),c&&c.d()}}}function Ra(e,t,r){let a,o=n,s=()=>(o(),o=u(i,e=>r(1,a=e)),i);e.$$.on_destroy.push(()=>o());let{client:i}=t;s();let{clientManager:l}=t;return e.$set=e=>{"client"in e&&s(r(0,i=e.client)),"clientManager"in e&&r(2,l=e.clientManager)},[i,a,l]}class Ua extends Pe{constructor(e){var t;super(),document.getElementById("svelte-1yzq5o8-style")||((t=E("style")).id="svelte-1yzq5o8-style",t.textContent=".gameinfo.svelte-1yzq5o8{padding:10px}",x(document.head,t)),we(this,e,Ra,La,c,{client:0,clientManager:2})}}function Va(e){let t,r;return{c(){t=E("div"),r=I(e[0]),D(t,"class","turn-marker svelte-6eza86"),D(t,"style",e[1])},m(e,n){w(e,t,n),x(t,r)},p(e,[t]){1&t&&S(r,e[0])},i:n,o:n,d(e){e&&P(t)}}}function Ja(e,t,n){let{turn:r}=t,{numEvents:a}=t;const o=`grid-row: span ${a}`;return e.$set=e=>{"turn"in e&&n(0,r=e.turn),"numEvents"in e&&n(2,a=e.numEvents)},[r,o,a]}class Ka extends Pe{constructor(e){var t;super(),document.getElementById("svelte-6eza86-style")||((t=E("style")).id="svelte-6eza86-style",t.textContent=".turn-marker.svelte-6eza86{display:flex;justify-content:center;align-items:center;grid-column:1;background:#555;color:#eee;text-align:center;font-weight:bold;border:1px solid #888}",x(document.head,t)),we(this,e,Ja,Va,c,{turn:0,numEvents:2})}}function Fa(e){let t,r,a=(e[0]||"")+"";return{c(){t=E("div"),r=I(a),D(t,"class","phase-marker svelte-1t4xap"),D(t,"style",e[1])},m(e,n){w(e,t,n),x(t,r)},p(e,[t]){1&t&&a!==(a=(e[0]||"")+"")&&S(r,a)},i:n,o:n,d(e){e&&P(t)}}}function Wa(e,t,n){let{phase:r}=t,{numEvents:a}=t;const o=`grid-row: span ${a}`;return e.$set=e=>{"phase"in e&&n(0,r=e.phase),"numEvents"in e&&n(2,a=e.numEvents)},[r,o,a]}class Ha extends Pe{constructor(e){var t;super(),document.getElementById("svelte-1t4xap-style")||((t=E("style")).id="svelte-1t4xap-style",t.textContent=".phase-marker.svelte-1t4xap{grid-column:3;background:#555;border:1px solid #888;color:#eee;text-align:center;font-weight:bold;padding-top:10px;padding-bottom:10px;text-orientation:sideways;writing-mode:vertical-rl;line-height:30px;width:100%}",x(document.head,t)),we(this,e,Wa,Fa,c,{phase:0,numEvents:2})}}function Ya(e){let t;return{c(){t=E("div"),t.textContent=`${e[0]}`},m(e,n){w(e,t,n)},p:n,i:n,o:n,d(e){e&&P(t)}}}function Xa(e,t,n){let{metadata:r}=t;const a=void 0!==r?JSON.stringify(r,null,4):"";return e.$set=e=>{"metadata"in e&&n(1,r=e.metadata)},[a,r]}class Za extends Pe{constructor(e){super(),we(this,e,Xa,Ya,c,{metadata:1})}}function Qa(e){let t,n;return t=new Za({props:{metadata:e[2]}}),{c(){ge(t.$$.fragment)},m(e,r){be(t,e,r),n=!0},p(e,n){const r={};4&n&&(r.metadata=e[2]),t.$set(r)},i(e){n||(fe(t.$$.fragment,e),n=!0)},o(e){ve(t.$$.fragment,e),n=!1},d(e){$e(t,e)}}}function eo(e){let t,n,r;var a=e[3];function o(e){return{props:{metadata:e[2]}}}return a&&(t=new a(o(e))),{c(){t&&ge(t.$$.fragment),n=A()},m(e,a){t&&be(t,e,a),w(e,n,a),r=!0},p(e,r){const s={};if(4&r&&(s.metadata=e[2]),a!==(a=e[3])){if(t){de();const e=t;ve(e.$$.fragment,1,0,()=>{$e(e,1)}),pe()}a?(t=new a(o(e)),ge(t.$$.fragment),fe(t.$$.fragment,1),be(t,n.parentNode,n)):t=null}else a&&t.$set(s)},i(e){r||(t&&fe(t.$$.fragment,e),r=!0)},o(e){t&&ve(t.$$.fragment,e),r=!1},d(e){e&&P(n),t&&$e(t,e)}}}function to(e){let t,n,r,a,o,s,l,c,u,d,p,f,v;const m=[eo,Qa],y=[];function h(e,t){return e[3]?0:1}return c=h(e),u=y[c]=m[c](e),{c(){t=E("button"),n=E("div"),r=I(e[4]),a=I("("),o=I(e[6]),s=I(")"),l=j(),u.c(),D(n,"class","args svelte-vajd9z"),D(t,"class",d="log-event player"+e[7]+" svelte-vajd9z"),T(t,"pinned",e[1])},m(i,u){w(i,t,u),x(t,n),x(n,r),x(n,a),x(n,o),x(n,s),x(t,l),y[c].m(t,null),p=!0,f||(v=[_(t,"click",e[9]),_(t,"mouseenter",e[10]),_(t,"focus",e[11]),_(t,"mouseleave",e[12]),_(t,"blur",e[13])],f=!0)},p(e,[n]){(!p||16&n)&&S(r,e[4]);let a=c;c=h(e),c===a?y[c].p(e,n):(de(),ve(y[a],1,1,()=>{y[a]=null}),pe(),u=y[c],u||(u=y[c]=m[c](e),u.c()),fe(u,1),u.m(t,null)),2&n&&T(t,"pinned",e[1])},i(e){p||(fe(u),p=!0)},o(e){ve(u),p=!1},d(e){e&&P(t),y[c].d(),f=!1,i(v)}}}function no(e,t,n){let{logIndex:r}=t,{action:a}=t,{pinned:o}=t,{metadata:s}=t,{metadataComponent:i}=t;const l=K(),c=a.payload.args,u=Array.isArray(c)?c.map(e=>JSON.stringify(e,null,2)).join(","):JSON.stringify(c,null,2)||"",d=a.payload.playerID;let p;switch(a.type){case"UNDO":p="undo";break;case"REDO":p="redo";case"GAME_EVENT":case"MAKE_MOVE":default:p=a.payload.type}return e.$set=e=>{"logIndex"in e&&n(0,r=e.logIndex),"action"in e&&n(8,a=e.action),"pinned"in e&&n(1,o=e.pinned),"metadata"in e&&n(2,s=e.metadata),"metadataComponent"in e&&n(3,i=e.metadataComponent)},[r,o,s,i,p,l,u,d,a,()=>l("click",{logIndex:r}),()=>l("mouseenter",{logIndex:r}),()=>l("mouseenter",{logIndex:r}),()=>l("mouseleave"),()=>l("mouseleave")]}class ro extends Pe{constructor(e){var t;super(),document.getElementById("svelte-vajd9z-style")||((t=E("style")).id="svelte-vajd9z-style",t.textContent=".log-event.svelte-vajd9z{grid-column:2;cursor:pointer;overflow:hidden;display:flex;flex-direction:column;justify-content:center;background:#fff;border:1px dotted #ccc;border-left:5px solid #ccc;padding:5px;text-align:center;color:#666;font-size:14px;min-height:25px;line-height:25px}.log-event.svelte-vajd9z:hover,.log-event.svelte-vajd9z:focus{border-style:solid;background:#eee}.log-event.pinned.svelte-vajd9z{border-style:solid;background:#eee;opacity:1}.args.svelte-vajd9z{text-align:left;white-space:pre-wrap}.player0.svelte-vajd9z{border-left-color:#ff851b}.player1.svelte-vajd9z{border-left-color:#7fdbff}.player2.svelte-vajd9z{border-left-color:#0074d9}.player3.svelte-vajd9z{border-left-color:#39cccc}.player4.svelte-vajd9z{border-left-color:#3d9970}.player5.svelte-vajd9z{border-left-color:#2ecc40}.player6.svelte-vajd9z{border-left-color:#01ff70}.player7.svelte-vajd9z{border-left-color:#ffdc00}.player8.svelte-vajd9z{border-left-color:#001f3f}.player9.svelte-vajd9z{border-left-color:#ff4136}.player10.svelte-vajd9z{border-left-color:#85144b}.player11.svelte-vajd9z{border-left-color:#f012be}.player12.svelte-vajd9z{border-left-color:#b10dc9}.player13.svelte-vajd9z{border-left-color:#111111}.player14.svelte-vajd9z{border-left-color:#aaaaaa}.player15.svelte-vajd9z{border-left-color:#dddddd}",x(document.head,t)),we(this,e,no,to,c,{logIndex:0,action:8,pinned:1,metadata:2,metadataComponent:3})}}function ao(e){let t,n;return{c(){t=O("title"),n=I(e[0])},m(e,r){w(e,t,r),x(t,n)},p(e,t){1&t&&S(n,e[0])},d(e){e&&P(t)}}}function oo(e){let t,n,r,a=e[0]&&ao(e);const o=e[3].default,s=function(e,t,n,r){if(e){const a=p(e,t,n,r);return e[0](a)}}(o,e,e[2],null);return{c(){t=O("svg"),a&&a.c(),n=A(),s&&s.c(),D(t,"xmlns","http://www.w3.org/2000/svg"),D(t,"viewBox",e[1]),D(t,"class","svelte-c8tyih")},m(e,o){w(e,t,o),a&&a.m(t,null),x(t,n),s&&s.m(t,null),r=!0},p(e,[i]){e[0]?a?a.p(e,i):(a=ao(e),a.c(),a.m(t,n)):a&&(a.d(1),a=null),s&&s.p&&4&i&&f(s,o,e,e[2],i,null,null),(!r||2&i)&&D(t,"viewBox",e[1])},i(e){r||(fe(s,e),r=!0)},o(e){ve(s,e),r=!1},d(e){e&&P(t),a&&a.d(),s&&s.d(e)}}}function so(e,t,n){let{title:r=null}=t,{viewBox:a}=t,{$$slots:o={},$$scope:s}=t;return e.$set=e=>{"title"in e&&n(0,r=e.title),"viewBox"in e&&n(1,a=e.viewBox),"$$scope"in e&&n(2,s=e.$$scope)},[r,a,s,o]}class io extends Pe{constructor(e){var t;super(),document.getElementById("svelte-c8tyih-style")||((t=E("style")).id="svelte-c8tyih-style",t.textContent="svg.svelte-c8tyih{stroke:currentColor;fill:currentColor;stroke-width:0;width:100%;height:auto;max-height:100%}",x(document.head,t)),we(this,e,so,oo,c,{title:0,viewBox:1})}}function lo(e){let t;return{c(){t=O("path"),D(t,"d","M504 256c0 137-111 248-248 248S8 393 8 256 119 8 256 8s248 111 248 248zM212 140v116h-70.9c-10.7 0-16.1 13-8.5 20.5l114.9 114.3c4.7 4.7 12.2 4.7 16.9 0l114.9-114.3c7.6-7.6 2.2-20.5-8.5-20.5H300V140c0-6.6-5.4-12-12-12h-64c-6.6 0-12 5.4-12 12z")},m(e,n){w(e,t,n)},d(e){e&&P(t)}}}function co(e){let t,n;const r=[{viewBox:"0 0 512 512"},e[0]];let o={$$slots:{default:[lo]},$$scope:{ctx:e}};for(let e=0;e<r.length;e+=1)o=a(o,r[e]);return t=new io({props:o}),{c(){ge(t.$$.fragment)},m(e,r){be(t,e,r),n=!0},p(e,[n]){const a=1&n?function(e,t){const n={},r={},a={$$scope:1};let o=e.length;for(;o--;){const s=e[o],i=t[o];if(i){for(const e in s)e in i||(r[e]=1);for(const e in i)a[e]||(n[e]=i[e],a[e]=1);e[o]=i}else for(const e in s)a[e]=1}for(const e in r)e in n||(n[e]=void 0);return n}(r,[r[0],(o=e[0],"object"==typeof o&&null!==o?o:{})]):{};var o;2&n&&(a.$$scope={dirty:n,ctx:e}),t.$set(a)},i(e){n||(fe(t.$$.fragment,e),n=!0)},o(e){ve(t.$$.fragment,e),n=!1},d(e){$e(t,e)}}}function uo(e,t,n){return e.$set=e=>{n(0,t=a(a({},t),v(e)))},[t=v(t)]}class po extends Pe{constructor(e){super(),we(this,e,uo,co,c,{})}}function fo(e){let t,r;return{c(){t=E("div"),r=I(e[0]),D(t,"alt",e[0]),D(t,"class","svelte-1a7time")},m(e,n){w(e,t,n),x(t,r)},p(e,[n]){1&n&&S(r,e[0]),1&n&&D(t,"alt",e[0])},i:n,o:n,d(e){e&&P(t)}}}function vo(e,t,n){let r,{action:a}=t;return e.$set=e=>{"action"in e&&n(1,a=e.action)},e.$$.update=()=>{if(2&e.$$.dirty){const{type:e,args:t}=a.payload,o=(t||[]).join(",");n(0,r=`${e}(${o})`)}},[r,a]}class mo extends Pe{constructor(e){var t;super(),document.getElementById("svelte-1a7time-style")||((t=E("style")).id="svelte-1a7time-style",t.textContent="div.svelte-1a7time{white-space:nowrap;text-overflow:ellipsis;overflow:hidden;max-width:500px}",x(document.head,t)),we(this,e,vo,fo,c,{action:1})}}function yo(e,t,n){const r=e.slice();return r[10]=t[n],r[12]=n,r}function ho(e){let t,n,r,a,o,s,l,c,u,d,p,f,v,m=e[10].value+"",y=e[10].visits+"";function h(...t){return e[5](e[10],e[12],...t)}function g(...t){return e[6](e[12],...t)}function b(...t){return e[7](e[10],e[12],...t)}return u=new mo({props:{action:e[10].parentAction}}),{c(){t=E("tr"),n=E("td"),r=I(m),a=j(),o=E("td"),s=I(y),l=j(),c=E("td"),ge(u.$$.fragment),d=j(),D(n,"class","svelte-ztcwsu"),D(o,"class","svelte-ztcwsu"),D(c,"class","svelte-ztcwsu"),D(t,"class","svelte-ztcwsu"),T(t,"clickable",e[1].length>0),T(t,"selected",e[12]===e[0])},m(e,i){w(e,t,i),x(t,n),x(n,r),x(t,a),x(t,o),x(o,s),x(t,l),x(t,c),be(u,c,null),x(t,d),p=!0,f||(v=[_(t,"click",h),_(t,"mouseout",g),_(t,"mouseover",b)],f=!0)},p(n,a){e=n,(!p||2&a)&&m!==(m=e[10].value+"")&&S(r,m),(!p||2&a)&&y!==(y=e[10].visits+"")&&S(s,y);const o={};2&a&&(o.action=e[10].parentAction),u.$set(o),2&a&&T(t,"clickable",e[1].length>0),1&a&&T(t,"selected",e[12]===e[0])},i(e){p||(fe(u.$$.fragment,e),p=!0)},o(e){ve(u.$$.fragment,e),p=!1},d(e){e&&P(t),$e(u),f=!1,i(v)}}}function go(e){let t,n,r,a,o,s=e[1],i=[];for(let t=0;t<s.length;t+=1)i[t]=ho(yo(e,s,t));const l=e=>ve(i[e],1,1,()=>{i[e]=null});return{c(){t=E("table"),n=E("thead"),n.innerHTML='<th class="svelte-ztcwsu">Value</th> \n    <th class="svelte-ztcwsu">Visits</th> \n    <th class="svelte-ztcwsu">Action</th>',r=j(),a=E("tbody");for(let e=0;e<i.length;e+=1)i[e].c();D(t,"class","svelte-ztcwsu")},m(e,s){w(e,t,s),x(t,n),x(t,r),x(t,a);for(let e=0;e<i.length;e+=1)i[e].m(a,null);o=!0},p(e,[t]){if(15&t){let n;for(s=e[1],n=0;n<s.length;n+=1){const r=yo(e,s,n);i[n]?(i[n].p(r,t),fe(i[n],1)):(i[n]=ho(r),i[n].c(),fe(i[n],1),i[n].m(a,null))}for(de(),n=s.length;n<i.length;n+=1)l(n);pe()}},i(e){if(!o){for(let e=0;e<s.length;e+=1)fe(i[e]);o=!0}},o(e){i=i.filter(Boolean);for(let e=0;e<i.length;e+=1)ve(i[e]);o=!1},d(e){e&&P(t),k(i,e)}}}function bo(e,t,n){let{root:r}=t,{selectedIndex:a=null}=t;const o=K();let s=[],i=[];function l(e,t){o("select",{node:e,selectedIndex:t})}function c(e,t){null===a&&o("preview",{node:e})}return e.$set=e=>{"root"in e&&n(4,r=e.root),"selectedIndex"in e&&n(0,a=e.selectedIndex)},e.$$.update=()=>{if(272&e.$$.dirty){let e=r;for(n(8,s=[]);e.parent;){const t=e.parent,{type:n,args:r}=e.parentAction.payload,a=`${n}(${(r||[]).join(",")})`;s.push({parent:t,arrowText:a}),e=t}s.reverse(),n(1,i=[...r.children].sort((e,t)=>e.visits<t.visits?1:-1).slice(0,50))}},[a,i,l,c,r,(e,t)=>l(e,t),e=>c(null),(e,t)=>c(e)]}class $o extends Pe{constructor(e){var t;super(),document.getElementById("svelte-ztcwsu-style")||((t=E("style")).id="svelte-ztcwsu-style",t.textContent="table.svelte-ztcwsu.svelte-ztcwsu{font-size:12px;border-collapse:collapse;border:1px solid #ddd;padding:0}tr.svelte-ztcwsu.svelte-ztcwsu{cursor:pointer}tr.svelte-ztcwsu:hover td.svelte-ztcwsu{background:#eee}tr.selected.svelte-ztcwsu td.svelte-ztcwsu{background:#eee}td.svelte-ztcwsu.svelte-ztcwsu{padding:10px;height:10px;line-height:10px;font-size:12px;border:none}th.svelte-ztcwsu.svelte-ztcwsu{background:#888;color:#fff;padding:10px;text-align:center}",x(document.head,t)),we(this,e,bo,go,c,{root:4,selectedIndex:0})}}function xo(e,t,n){const r=e.slice();return r[9]=t[n].node,r[10]=t[n].selectedIndex,r[12]=n,r}function wo(e){let t,n;return t=new $o({props:{root:e[9],selectedIndex:e[10]}}),t.$on("select",(function(...t){return e[7](e[12],...t)})),{c(){ge(t.$$.fragment)},m(e,r){be(t,e,r),n=!0},p(n,r){e=n;const a={};1&r&&(a.root=e[9]),1&r&&(a.selectedIndex=e[10]),t.$set(a)},i(e){n||(fe(t.$$.fragment,e),n=!0)},o(e){ve(t.$$.fragment,e),n=!1},d(e){$e(t,e)}}}function Po(e){let t,n;return t=new $o({props:{root:e[9]}}),t.$on("select",(function(...t){return e[5](e[12],...t)})),t.$on("preview",(function(...t){return e[6](e[12],...t)})),{c(){ge(t.$$.fragment)},m(e,r){be(t,e,r),n=!0},p(n,r){e=n;const a={};1&r&&(a.root=e[9]),t.$set(a)},i(e){n||(fe(t.$$.fragment,e),n=!0)},o(e){ve(t.$$.fragment,e),n=!1},d(e){$e(t,e)}}}function ko(e){let t,n,r,a,o,s=0!==e[12]&&function(e){let t,n,r;return n=new po({}),{c(){t=E("div"),ge(n.$$.fragment),D(t,"class","icon svelte-1f0amz4")},m(e,a){w(e,t,a),be(n,t,null),r=!0},i(e){r||(fe(n.$$.fragment,e),r=!0)},o(e){ve(n.$$.fragment,e),r=!1},d(e){e&&P(t),$e(n)}}}();const i=[Po,wo],l=[];function c(e,t){return e[12]===e[0].length-1?0:1}return r=c(e),a=l[r]=i[r](e),{c(){s&&s.c(),t=j(),n=E("section"),a.c()},m(e,a){s&&s.m(e,a),w(e,t,a),w(e,n,a),l[r].m(n,null),o=!0},p(e,t){let o=r;r=c(e),r===o?l[r].p(e,t):(de(),ve(l[o],1,1,()=>{l[o]=null}),pe(),a=l[r],a||(a=l[r]=i[r](e),a.c()),fe(a,1),a.m(n,null))},i(e){o||(fe(s),fe(a),o=!0)},o(e){ve(s),ve(a),o=!1},d(e){s&&s.d(e),e&&P(t),e&&P(n),l[r].d()}}}function Eo(e){let t,n,r,a,o,s;return n=new po({}),o=new $o({props:{root:e[1]}}),{c(){t=E("div"),ge(n.$$.fragment),r=j(),a=E("section"),ge(o.$$.fragment),D(t,"class","icon svelte-1f0amz4"),D(a,"class","preview svelte-1f0amz4")},m(e,i){w(e,t,i),be(n,t,null),w(e,r,i),w(e,a,i),be(o,a,null),s=!0},p(e,t){const n={};2&t&&(n.root=e[1]),o.$set(n)},i(e){s||(fe(n.$$.fragment,e),fe(o.$$.fragment,e),s=!0)},o(e){ve(n.$$.fragment,e),ve(o.$$.fragment,e),s=!1},d(e){e&&P(t),$e(n),e&&P(r),e&&P(a),$e(o)}}}function Oo(e){let t,n,r,a=e[0],o=[];for(let t=0;t<a.length;t+=1)o[t]=ko(xo(e,a,t));const s=e=>ve(o[e],1,1,()=>{o[e]=null});let i=e[1]&&Eo(e);return{c(){t=E("div");for(let e=0;e<o.length;e+=1)o[e].c();n=j(),i&&i.c(),D(t,"class","visualizer svelte-1f0amz4")},m(e,a){w(e,t,a);for(let e=0;e<o.length;e+=1)o[e].m(t,null);x(t,n),i&&i.m(t,null),r=!0},p(e,[r]){if(13&r){let i;for(a=e[0],i=0;i<a.length;i+=1){const s=xo(e,a,i);o[i]?(o[i].p(s,r),fe(o[i],1)):(o[i]=ko(s),o[i].c(),fe(o[i],1),o[i].m(t,n))}for(de(),i=a.length;i<o.length;i+=1)s(i);pe()}e[1]?i?(i.p(e,r),2&r&&fe(i,1)):(i=Eo(e),i.c(),fe(i,1),i.m(t,null)):i&&(de(),ve(i,1,1,()=>{i=null}),pe())},i(e){if(!r){for(let e=0;e<a.length;e+=1)fe(o[e]);fe(i),r=!0}},o(e){o=o.filter(Boolean);for(let e=0;e<o.length;e+=1)ve(o[e]);ve(i),r=!1},d(e){e&&P(t),k(o,e),i&&i.d()}}}function Io(e,t,n){let{metadata:r}=t,a=[],o=null;function s({node:e,selectedIndex:t},r){n(1,o=null),n(0,a[r].selectedIndex=t,a),n(0,a=[...a.slice(0,r+1),{node:e}])}function i({node:e},t){n(1,o=e)}return e.$set=e=>{"metadata"in e&&n(4,r=e.metadata)},e.$$.update=()=>{16&e.$$.dirty&&n(0,a=[{node:r}])},[a,o,s,i,r,(e,t)=>s(t.detail,e),(e,t)=>i(t.detail),(e,t)=>s(t.detail,e)]}class jo extends Pe{constructor(e){var t;super(),document.getElementById("svelte-1f0amz4-style")||((t=E("style")).id="svelte-1f0amz4-style",t.textContent=".visualizer.svelte-1f0amz4{display:flex;flex-direction:column;align-items:center;padding:50px}.preview.svelte-1f0amz4{opacity:0.5}.icon.svelte-1f0amz4{color:#777;width:32px;height:32px;margin-bottom:20px}",x(document.head,t)),we(this,e,Io,Oo,c,{metadata:4})}}function Ao(e,t,n){const r=e.slice();return r[16]=t[n].phase,r[18]=n,r}function _o(e,t,n){const r=e.slice();return r[19]=t[n].action,r[20]=t[n].metadata,r[18]=n,r}function Do(e,t,n){const r=e.slice();return r[22]=t[n].turn,r[18]=n,r}function So(e){let t,n;return t=new Ka({props:{turn:e[22],numEvents:e[3][e[18]]}}),{c(){ge(t.$$.fragment)},m(e,r){be(t,e,r),n=!0},p(e,n){const r={};4&n&&(r.turn=e[22]),8&n&&(r.numEvents=e[3][e[18]]),t.$set(r)},i(e){n||(fe(t.$$.fragment,e),n=!0)},o(e){ve(t.$$.fragment,e),n=!1},d(e){$e(t,e)}}}function Mo(e){let t,n,r=e[18]in e[3]&&So(e);return{c(){r&&r.c(),t=A()},m(e,a){r&&r.m(e,a),w(e,t,a),n=!0},p(e,n){e[18]in e[3]?r?(r.p(e,n),8&n&&fe(r,1)):(r=So(e),r.c(),fe(r,1),r.m(t.parentNode,t)):r&&(de(),ve(r,1,1,()=>{r=null}),pe())},i(e){n||(fe(r),n=!0)},o(e){ve(r),n=!1},d(e){r&&r.d(e),e&&P(t)}}}function Co(e){let t,n;return t=new ro({props:{pinned:e[18]===e[1],logIndex:e[18],action:e[19],metadata:e[20]}}),t.$on("click",e[5]),t.$on("mouseenter",e[6]),t.$on("mouseleave",e[7]),{c(){ge(t.$$.fragment)},m(e,r){be(t,e,r),n=!0},p(e,n){const r={};2&n&&(r.pinned=e[18]===e[1]),4&n&&(r.action=e[19]),4&n&&(r.metadata=e[20]),t.$set(r)},i(e){n||(fe(t.$$.fragment,e),n=!0)},o(e){ve(t.$$.fragment,e),n=!1},d(e){$e(t,e)}}}function No(e){let t,n;return t=new Ha({props:{phase:e[16],numEvents:e[4][e[18]]}}),{c(){ge(t.$$.fragment)},m(e,r){be(t,e,r),n=!0},p(e,n){const r={};4&n&&(r.phase=e[16]),16&n&&(r.numEvents=e[4][e[18]]),t.$set(r)},i(e){n||(fe(t.$$.fragment,e),n=!0)},o(e){ve(t.$$.fragment,e),n=!1},d(e){$e(t,e)}}}function To(e){let t,n,r=e[18]in e[4]&&No(e);return{c(){r&&r.c(),t=A()},m(e,a){r&&r.m(e,a),w(e,t,a),n=!0},p(e,n){e[18]in e[4]?r?(r.p(e,n),16&n&&fe(r,1)):(r=No(e),r.c(),fe(r,1),r.m(t.parentNode,t)):r&&(de(),ve(r,1,1,()=>{r=null}),pe())},i(e){n||(fe(r),n=!0)},o(e){ve(r),n=!1},d(e){r&&r.d(e),e&&P(t)}}}function zo(e){let t,n,r,a,o,s,i=e[2],l=[];for(let t=0;t<i.length;t+=1)l[t]=Mo(Do(e,i,t));const c=e=>ve(l[e],1,1,()=>{l[e]=null});let u=e[2],d=[];for(let t=0;t<u.length;t+=1)d[t]=Co(_o(e,u,t));const p=e=>ve(d[e],1,1,()=>{d[e]=null});let f=e[2],v=[];for(let t=0;t<f.length;t+=1)v[t]=To(Ao(e,f,t));const m=e=>ve(v[e],1,1,()=>{v[e]=null});return{c(){t=E("div");for(let e=0;e<l.length;e+=1)l[e].c();n=j();for(let e=0;e<d.length;e+=1)d[e].c();r=j();for(let e=0;e<v.length;e+=1)v[e].c();D(t,"class","gamelog svelte-1pq5e4b"),T(t,"pinned",e[1])},m(i,c){w(i,t,c);for(let e=0;e<l.length;e+=1)l[e].m(t,null);x(t,n);for(let e=0;e<d.length;e+=1)d[e].m(t,null);x(t,r);for(let e=0;e<v.length;e+=1)v[e].m(t,null);a=!0,o||(s=_(window,"keydown",e[8]),o=!0)},p(e,[a]){if(12&a){let r;for(i=e[2],r=0;r<i.length;r+=1){const o=Do(e,i,r);l[r]?(l[r].p(o,a),fe(l[r],1)):(l[r]=Mo(o),l[r].c(),fe(l[r],1),l[r].m(t,n))}for(de(),r=i.length;r<l.length;r+=1)c(r);pe()}if(230&a){let n;for(u=e[2],n=0;n<u.length;n+=1){const o=_o(e,u,n);d[n]?(d[n].p(o,a),fe(d[n],1)):(d[n]=Co(o),d[n].c(),fe(d[n],1),d[n].m(t,r))}for(de(),n=u.length;n<d.length;n+=1)p(n);pe()}if(20&a){let n;for(f=e[2],n=0;n<f.length;n+=1){const r=Ao(e,f,n);v[n]?(v[n].p(r,a),fe(v[n],1)):(v[n]=To(r),v[n].c(),fe(v[n],1),v[n].m(t,null))}for(de(),n=f.length;n<v.length;n+=1)m(n);pe()}2&a&&T(t,"pinned",e[1])},i(e){if(!a){for(let e=0;e<i.length;e+=1)fe(l[e]);for(let e=0;e<u.length;e+=1)fe(d[e]);for(let e=0;e<f.length;e+=1)fe(v[e]);a=!0}},o(e){l=l.filter(Boolean);for(let e=0;e<l.length;e+=1)ve(l[e]);d=d.filter(Boolean);for(let e=0;e<d.length;e+=1)ve(d[e]);v=v.filter(Boolean);for(let e=0;e<v.length;e+=1)ve(v[e]);a=!1},d(e){e&&P(t),k(l,e),k(d,e),k(v,e),o=!1,s()}}}function Go(e,t,r){let a,o=n,s=()=>(o(),o=u(i,e=>r(10,a=e)),i);e.$$.on_destroy.push(()=>o());let{client:i}=t;s();const{secondaryPane:l}=W("secondaryPane"),c=Nn({game:i.game}),d=i.getInitialState();let p,{log:f}=a,v=null;function m(e){let t=d;for(let n=0;n<f.length;n++){const{action:r,automatic:a}=f[n];if(!a){if(t=c(t,r),0==e)break;e--}}return{G:t.G,ctx:t.ctx,plugins:t.plugins}}function y(){r(1,v=null),i.overrideGameState(null),l.set(null)}J(y);let h={},g={};return e.$set=e=>{"client"in e&&s(r(0,i=e.client))},e.$$.update=()=>{if(1540&e.$$.dirty){r(9,f=a.log),r(2,p=f.filter(e=>!e.automatic));let e=0,t=0;r(3,h={}),r(4,g={});for(let n=0;n<p.length;n++){const{action:a,payload:o,turn:s,phase:i}=p[n];t++,e++,n!=p.length-1&&p[n+1].turn==s||(r(3,h[n]=t,h),t=0),n!=p.length-1&&p[n+1].phase==i||(r(4,g[n]=e,g),e=0)}}},[i,v,p,h,g,function(e){const{logIndex:t}=e.detail,n=m(t),a=f.filter(e=>!e.automatic);if(i.overrideGameState(n),v==t)r(1,v=null),l.set(null);else{r(1,v=t);const{metadata:e}=a[t].action.payload;e&&l.set({component:jo,metadata:e})}},function(e){const{logIndex:t}=e.detail;if(null===v){const e=m(t);i.overrideGameState(e)}},function(){null===v&&i.overrideGameState(null)},function(e){27==e.keyCode&&y()}]}class qo extends Pe{constructor(e){var t;super(),document.getElementById("svelte-1pq5e4b-style")||((t=E("style")).id="svelte-1pq5e4b-style",t.textContent=".gamelog.svelte-1pq5e4b{display:grid;grid-template-columns:30px 1fr 30px;grid-auto-rows:auto;grid-auto-flow:column}",x(document.head,t)),we(this,e,Go,zo,c,{client:0})}}function Bo(e,t,n){const r=e.slice();return r[5]=t[n][0],r[6]=t[n][1],r}function Lo(e){let t,n,r,a,o,s,l,c,u=e[1][e[5]]+"";function d(){e[3].call(a,e[5])}return{c(){t=E("span"),n=I(u),r=j(),a=E("input"),D(t,"class","value svelte-1fu900w"),D(a,"type","range"),D(a,"min",o=e[6].range.min),D(a,"max",s=e[6].range.max)},m(o,s){w(o,t,s),x(t,n),w(o,r,s),w(o,a,s),M(a,e[1][e[5]]),l||(c=[_(a,"change",d),_(a,"input",d),_(a,"change",e[2])],l=!0)},p(t,r){e=t,3&r&&u!==(u=e[1][e[5]]+"")&&S(n,u),1&r&&o!==(o=e[6].range.min)&&D(a,"min",o),1&r&&s!==(s=e[6].range.max)&&D(a,"max",s),3&r&&M(a,e[1][e[5]])},d(e){e&&P(t),e&&P(r),e&&P(a),l=!1,i(c)}}}function Ro(e){let t,n,r;function a(){e[4].call(t,e[5])}return{c(){t=E("input"),D(t,"type","checkbox"),D(t,"class","svelte-1fu900w")},m(o,s){w(o,t,s),t.checked=e[1][e[5]],n||(r=[_(t,"change",a),_(t,"change",e[2])],n=!0)},p(n,r){e=n,3&r&&(t.checked=e[1][e[5]])},d(e){e&&P(t),n=!1,i(r)}}}function Uo(e){let t,n,r,a,o,s,i=e[5]+"",l=e[6].range&&Lo(e),c="boolean"==typeof e[6].value&&Ro(e);return{c(){t=E("div"),n=E("label"),r=I(i),a=j(),l&&l.c(),o=j(),c&&c.c(),s=j(),D(n,"class","svelte-1fu900w"),D(t,"class","option svelte-1fu900w")},m(e,i){w(e,t,i),x(t,n),x(n,r),x(t,a),l&&l.m(t,null),x(t,o),c&&c.m(t,null),x(t,s)},p(e,n){1&n&&i!==(i=e[5]+"")&&S(r,i),e[6].range?l?l.p(e,n):(l=Lo(e),l.c(),l.m(t,o)):l&&(l.d(1),l=null),"boolean"==typeof e[6].value?c?c.p(e,n):(c=Ro(e),c.c(),c.m(t,s)):c&&(c.d(1),c=null)},d(e){e&&P(t),l&&l.d(),c&&c.d()}}}function Vo(e){let t,r=Object.entries(e[0].opts()),a=[];for(let t=0;t<r.length;t+=1)a[t]=Uo(Bo(e,r,t));return{c(){for(let e=0;e<a.length;e+=1)a[e].c();t=A()},m(e,n){for(let t=0;t<a.length;t+=1)a[t].m(e,n);w(e,t,n)},p(e,[n]){if(7&n){let o;for(r=Object.entries(e[0].opts()),o=0;o<r.length;o+=1){const s=Bo(e,r,o);a[o]?a[o].p(s,n):(a[o]=Uo(s),a[o].c(),a[o].m(t.parentNode,t))}for(;o<a.length;o+=1)a[o].d(1);a.length=r.length}},i:n,o:n,d(e){k(a,e),e&&P(t)}}}function Jo(e,t,n){let{bot:r}=t,a={};for(let[e,t]of Object.entries(r.opts()))a[e]=t.value;return e.$set=e=>{"bot"in e&&n(0,r=e.bot)},[r,a,function(){for(let[e,t]of Object.entries(a))r.setOpt(e,t)},function(e){var t;a[e]=""===(t=this.value)?void 0:+t,n(1,a),n(0,r)},function(e){a[e]=this.checked,n(1,a),n(0,r)}]}class Ko extends Pe{constructor(e){var t;super(),document.getElementById("svelte-1fu900w-style")||((t=E("style")).id="svelte-1fu900w-style",t.textContent="label.svelte-1fu900w{color:#666}.option.svelte-1fu900w{margin-bottom:20px}.value.svelte-1fu900w{font-weight:bold;color:#000}input[type='checkbox'].svelte-1fu900w{vertical-align:middle}",x(document.head,t)),we(this,e,Jo,Vo,c,{bot:0})}}class Fo{constructor({enumerate:e,seed:t}){this.enumerateFn=e,this.seed=t,this.iterationCounter=0,this._opts={}}addOpt({key:e,range:t,initial:n}){this._opts[e]={range:t,value:n}}getOpt(e){return this._opts[e].value}setOpt(e,t){e in this._opts&&(this._opts[e].value=t)}opts(){return this._opts}enumerate(e,t,n){return this.enumerateFn(e,t,n).map(e=>"payload"in e?e:"move"in e?Me(e.move,e.args,n):"event"in e?Ce(e.event,e.args,n):void 0)}random(e){let t;if(void 0!==this.seed){const e=qt(this.prngstate?"":this.seed,this.prngstate);t=e(),this.prngstate=e.state()}else t=Math.random();if(e){if(Array.isArray(e)){return e[Math.floor(t*e.length)]}return Math.floor(t*e)}return t}}class Wo extends Fo{constructor({enumerate:e,seed:t,objectives:n,game:r,iterations:a,playoutDepth:o,iterationCallback:s}){super({enumerate:e,seed:t}),void 0===n&&(n=()=>({})),this.objectives=n,this.iterationCallback=s||(()=>{}),this.reducer=Nn({game:r}),this.iterations=a,this.playoutDepth=o,this.addOpt({key:"async",initial:!1}),this.addOpt({key:"iterations",initial:"number"==typeof a?a:1e3,range:{min:1,max:2e3}}),this.addOpt({key:"playoutDepth",initial:"number"==typeof o?o:50,range:{min:1,max:100}})}createNode({state:e,parentAction:t,parent:n,playerID:r}){const{G:a,ctx:o}=e;let s=[],i=[];if(void 0!==r)s=this.enumerate(a,o,r),i=this.objectives(a,o,r);else if(o.activePlayers)for(const e in o.activePlayers)s=s.concat(this.enumerate(a,o,e)),i=i.concat(this.objectives(a,o,e));else s=s.concat(this.enumerate(a,o,o.currentPlayer)),i=i.concat(this.objectives(a,o,o.currentPlayer));return{state:e,parent:n,parentAction:t,actions:s,objectives:i,children:[],visits:0,value:0}}select(e){if(e.actions.length>0)return e;if(0==e.children.length)return e;let t=null,n=0;for(const r of e.children){const a=r.visits+Number.EPSILON,o=r.value/a+Math.sqrt(2*Math.log(e.visits)/a);(null==t||o>n)&&(n=o,t=r)}return this.select(t)}expand(e){const t=e.actions;if(0==t.length||void 0!==e.state.ctx.gameover)return e;const n=this.random(t.length),r=t[n];e.actions.splice(n,1);const a=this.reducer(e.state,r),o=this.createNode({state:a,parentAction:r,parent:e});return e.children.push(o),o}playout({state:e}){let t=this.getOpt("playoutDepth");"function"==typeof this.playoutDepth&&(t=this.playoutDepth(e.G,e.ctx));for(let n=0;n<t&&void 0===e.ctx.gameover;n++){const{G:t,ctx:n}=e;let r=n.currentPlayer;n.activePlayers&&(r=Object.keys(n.activePlayers)[0]);const a=this.enumerate(t,n,r),o=this.objectives(t,n,r),s=Object.keys(o).reduce((e,r)=>{const a=o[r];return a.checker(t,n)?e+a.weight:e},0);if(s>0)return{score:s};if(!a||0==a.length)return;const i=this.random(a.length);e=this.reducer(e,a[i])}return e.ctx.gameover}backpropagate(e,t={}){e.visits++,void 0!==t.score&&(e.value+=t.score),!0===t.draw&&(e.value+=.5),e.parentAction&&t.winner===e.parentAction.payload.playerID&&e.value++,e.parent&&this.backpropagate(e.parent,t)}play(e,t){const n=this.createNode({state:e,playerID:t});let r=this.getOpt("iterations");"function"==typeof this.iterations&&(r=this.iterations(e.G,e.ctx));const a=()=>{let e=null;for(const t of n.children)(null==e||t.visits>e.visits)&&(e=t);return{action:e&&e.parentAction,metadata:n}};return new Promise(e=>{const t=()=>{for(let e=0;e<25&&this.iterationCounter<r;e++){const e=this.select(n),t=this.expand(e),r=this.playout(t);this.backpropagate(t,r),this.iterationCounter++}this.iterationCallback({iterationCounter:this.iterationCounter,numIterations:r,metadata:n})};if(this.iterationCounter=0,this.getOpt("async")){const n=()=>{this.iterationCounter<r?(t(),setTimeout(n,0)):e(a())};n()}else{for(;this.iterationCounter<r;)t();e(a())}})}}class Ho extends Fo{play({G:e,ctx:t},n){const r=this.enumerate(e,t,n);return Promise.resolve({action:this.random(r)})}}async function Yo(e,t){const n=e.store.getState();let r=n.ctx.currentPlayer;n.ctx.activePlayers&&(r=Object.keys(n.ctx.activePlayers)[0]);const{action:a,metadata:o}=await t.play(n,r);if(a){const t={...a,payload:{...a.payload,metadata:o}};return e.store.dispatch(t),t}}function Xo(e,t,n){const r=e.slice();return r[7]=t[n],r}function Zo(e){let t,r,a;return{c(){t=E("p"),t.textContent="No bots available.",r=j(),a=E("p"),a.innerHTML='Follow the instructions\n        <a href="https://boardgame.io/documentation/#/tutorial?id=bots" target="_blank">here</a>\n        to set up bots.'},m(e,n){w(e,t,n),w(e,r,n),w(e,a,n)},p:n,i:n,o:n,d(e){e&&P(t),e&&P(r),e&&P(a)}}}function Qo(e){let t;return{c(){t=E("p"),t.textContent="The bot debugger is only available in singleplayer mode."},m(e,n){w(e,t,n)},p:n,i:n,o:n,d(e){e&&P(t)}}}function es(e){let t,n,r,a,o,s,l,c,u,d,p,f,v,m,y,h,g,b,$,O,I,S,M,N=Object.keys(e[7].opts()).length;s=new sa({props:{value:"1",onPress:e[13],label:"reset"}}),u=new sa({props:{value:"2",onPress:e[11],label:"play"}}),f=new sa({props:{value:"3",onPress:e[12],label:"simulate"}});let T=Object.keys(e[8]),z=[];for(let t=0;t<T.length;t+=1)z[t]=ts(Xo(e,T,t));let G=N&&ns(e),q=(e[5]||e[3])&&rs(e);return{c(){t=E("section"),n=E("h3"),n.textContent="Controls",r=j(),a=E("ul"),o=E("li"),ge(s.$$.fragment),l=j(),c=E("li"),ge(u.$$.fragment),d=j(),p=E("li"),ge(f.$$.fragment),v=j(),m=E("section"),y=E("h3"),y.textContent="Bot",h=j(),g=E("select");for(let e=0;e<z.length;e+=1)z[e].c();b=j(),G&&G.c(),$=j(),q&&q.c(),O=A(),D(n,"class","svelte-lifdi8"),D(o,"class","svelte-lifdi8"),D(c,"class","svelte-lifdi8"),D(p,"class","svelte-lifdi8"),D(a,"class","svelte-lifdi8"),D(y,"class","svelte-lifdi8"),void 0===e[4]&&ne(()=>e[16].call(g))},m(i,P){w(i,t,P),x(t,n),x(t,r),x(t,a),x(a,o),be(s,o,null),x(a,l),x(a,c),be(u,c,null),x(a,d),x(a,p),be(f,p,null),w(i,v,P),w(i,m,P),x(m,y),x(m,h),x(m,g);for(let e=0;e<z.length;e+=1)z[e].m(g,null);C(g,e[4]),w(i,b,P),G&&G.m(i,P),w(i,$,P),q&&q.m(i,P),w(i,O,P),I=!0,S||(M=[_(g,"change",e[16]),_(g,"change",e[10])],S=!0)},p(e,t){if(256&t){let n;for(T=Object.keys(e[8]),n=0;n<T.length;n+=1){const r=Xo(e,T,n);z[n]?z[n].p(r,t):(z[n]=ts(r),z[n].c(),z[n].m(g,null))}for(;n<z.length;n+=1)z[n].d(1);z.length=T.length}272&t&&C(g,e[4]),128&t&&(N=Object.keys(e[7].opts()).length),N?G?(G.p(e,t),128&t&&fe(G,1)):(G=ns(e),G.c(),fe(G,1),G.m($.parentNode,$)):G&&(de(),ve(G,1,1,()=>{G=null}),pe()),e[5]||e[3]?q?q.p(e,t):(q=rs(e),q.c(),q.m(O.parentNode,O)):q&&(q.d(1),q=null)},i(e){I||(fe(s.$$.fragment,e),fe(u.$$.fragment,e),fe(f.$$.fragment,e),fe(G),I=!0)},o(e){ve(s.$$.fragment,e),ve(u.$$.fragment,e),ve(f.$$.fragment,e),ve(G),I=!1},d(e){e&&P(t),$e(s),$e(u),$e(f),e&&P(v),e&&P(m),k(z,e),e&&P(b),G&&G.d(e),e&&P($),q&&q.d(e),e&&P(O),S=!1,i(M)}}}function ts(e){let t,r,a,o=e[7]+"";return{c(){t=E("option"),r=I(o),t.__value=a=e[7],t.value=t.__value},m(e,n){w(e,t,n),x(t,r)},p:n,d(e){e&&P(t)}}}function ns(e){let t,n,r,a,o,s,l,c,u,d,p;return c=new Ko({props:{bot:e[7]}}),{c(){t=E("section"),n=E("h3"),n.textContent="Options",r=j(),a=E("label"),a.textContent="debug",o=j(),s=E("input"),l=j(),ge(c.$$.fragment),D(n,"class","svelte-lifdi8"),D(a,"class","svelte-lifdi8"),D(s,"type","checkbox"),D(s,"class","svelte-lifdi8")},m(i,f){w(i,t,f),x(t,n),x(t,r),x(t,a),x(t,o),x(t,s),s.checked=e[1],x(t,l),be(c,t,null),u=!0,d||(p=[_(s,"change",e[17]),_(s,"change",e[9])],d=!0)},p(e,t){2&t&&(s.checked=e[1]);const n={};128&t&&(n.bot=e[7]),c.$set(n)},i(e){u||(fe(c.$$.fragment,e),u=!0)},o(e){ve(c.$$.fragment,e),u=!1},d(e){e&&P(t),$e(c),d=!1,i(p)}}}function rs(e){let t,n,r,a,o=e[2]&&e[2]<1&&as(e),s=e[5]&&os(e);return{c(){t=E("section"),n=E("h3"),n.textContent="Result",r=j(),o&&o.c(),a=j(),s&&s.c(),D(n,"class","svelte-lifdi8")},m(e,i){w(e,t,i),x(t,n),x(t,r),o&&o.m(t,null),x(t,a),s&&s.m(t,null)},p(e,n){e[2]&&e[2]<1?o?o.p(e,n):(o=as(e),o.c(),o.m(t,a)):o&&(o.d(1),o=null),e[5]?s?s.p(e,n):(s=os(e),s.c(),s.m(t,null)):s&&(s.d(1),s=null)},d(e){e&&P(t),o&&o.d(),s&&s.d()}}}function as(e){let t;return{c(){t=E("progress"),t.value=e[2]},m(e,n){w(e,t,n)},p(e,n){4&n&&(t.value=e[2])},d(e){e&&P(t)}}}function os(e){let t,n,r,a,o,s,i,l,c=JSON.stringify(e[6])+"";return{c(){t=E("ul"),n=E("li"),r=I("Action: "),a=I(e[5]),o=j(),s=E("li"),i=I("Args: "),l=I(c),D(n,"class","svelte-lifdi8"),D(s,"class","svelte-lifdi8"),D(t,"class","svelte-lifdi8")},m(e,c){w(e,t,c),x(t,n),x(n,r),x(n,a),x(t,o),x(t,s),x(s,i),x(s,l)},p(e,t){32&t&&S(a,e[5]),64&t&&c!==(c=JSON.stringify(e[6])+"")&&S(l,c)},d(e){e&&P(t)}}}function ss(e){let t,n,r,a,o,s;const i=[es,Qo,Zo],l=[];function c(e,t){return e[0].game.ai&&!e[0].multiplayer?0:e[0].multiplayer?1:2}return n=c(e),r=l[n]=i[n](e),{c(){t=E("section"),r.c()},m(r,i){w(r,t,i),l[n].m(t,null),a=!0,o||(s=_(window,"keydown",e[14]),o=!0)},p(e,[a]){let o=n;n=c(e),n===o?l[n].p(e,a):(de(),ve(l[o],1,1,()=>{l[o]=null}),pe(),r=l[n],r||(r=l[n]=i[n](e),r.c()),fe(r,1),r.m(t,null))},i(e){a||(fe(r),a=!0)},o(e){ve(r),a=!1},d(e){e&&P(t),l[n].d(),o=!1,s()}}}function is(e,t,n){let{client:r}=t,{clientManager:a}=t;const{secondaryPane:o}=W("secondaryPane"),s={MCTS:Wo,Random:Ho};let i=!1,l=null,c=0,u=null;const d=({iterationCounter:e,numIterations:t,metadata:r})=>{n(3,c=e),n(2,l=e/t),u=r,i&&u&&o.set({component:jo,metadata:u})};let p,f,v,m;function y(){r.overrideGameState(null),o.set(null),n(1,i=!1)}return r.game.ai&&(p=new Wo({game:r.game,enumerate:r.game.ai.enumerate,iterationCallback:d}),p.setOpt("async",!0)),J(y),e.$set=e=>{"client"in e&&n(0,r=e.client),"clientManager"in e&&n(15,a=e.clientManager)},[r,i,l,c,f,v,m,p,s,function(){i&&u?o.set({component:jo,metadata:u}):o.set(null)},function(){n(7,p=new(0,s[f])({game:r.game,enumerate:r.game.ai.enumerate,iterationCallback:d})),p.setOpt("async",!0),n(5,v=null),u=null,o.set(null),n(3,c=0)},async function(){n(5,v=null),u=null,n(3,c=0);const e=await Yo(r,p);e&&(n(5,v=e.payload.type),n(6,m=e.payload.args))},function(e=1e4,t=100){return n(5,v=null),u=null,n(3,c=0),(async()=>{for(let n=0;n<e;n++){if(!await Yo(r,p))break;await new Promise(e=>setTimeout(e,t))}})()},function(){r.reset(),n(5,v=null),u=null,n(3,c=0),y()},function(e){27==e.keyCode&&y()},a,function(){f=N(this),n(4,f),n(8,s)},function(){i=this.checked,n(1,i)}]}class ls extends Pe{constructor(e){var t;super(),document.getElementById("svelte-lifdi8-style")||((t=E("style")).id="svelte-lifdi8-style",t.textContent="ul.svelte-lifdi8{padding-left:0}li.svelte-lifdi8{list-style:none;margin:none;margin-bottom:5px}h3.svelte-lifdi8{text-transform:uppercase}label.svelte-lifdi8{color:#666}input[type='checkbox'].svelte-lifdi8{vertical-align:middle}",x(document.head,t)),we(this,e,is,ss,c,{client:0,clientManager:15})}}function cs(e){let t,n,r,a,o,s,i,l;n=new Fn({props:{panes:e[6],pane:e[2]}}),n.$on("change",e[8]);var c=e[6][e[2]].component;function u(e){return{props:{client:e[4],clientManager:e[0]}}}c&&(o=new c(u(e)));let d=e[5]&&us(e);return{c(){t=E("section"),ge(n.$$.fragment),r=j(),a=E("div"),o&&ge(o.$$.fragment),s=j(),d&&d.c(),D(a,"class","pane svelte-1dhkl71"),D(a,"role","region"),D(a,"aria-label",e[2]),D(a,"tabindex","-1"),D(t,"aria-label","boardgame.io Debug Panel"),D(t,"class","debug-panel svelte-1dhkl71")},m(i,c){w(i,t,c),be(n,t,null),x(t,r),x(t,a),o&&be(o,a,null),e[10](a),x(t,s),d&&d.m(t,null),l=!0},p(e,r){const s={};4&r&&(s.pane=e[2]),n.$set(s);const i={};if(16&r&&(i.client=e[4]),1&r&&(i.clientManager=e[0]),c!==(c=e[6][e[2]].component)){if(o){de();const e=o;ve(e.$$.fragment,1,0,()=>{$e(e,1)}),pe()}c?(o=new c(u(e)),ge(o.$$.fragment),fe(o.$$.fragment,1),be(o,a,null)):o=null}else c&&o.$set(i);(!l||4&r)&&D(a,"aria-label",e[2]),e[5]?d?(d.p(e,r),32&r&&fe(d,1)):(d=us(e),d.c(),fe(d,1),d.m(t,null)):d&&(de(),ve(d,1,1,()=>{d=null}),pe())},i(e){l||(fe(n.$$.fragment,e),o&&fe(o.$$.fragment,e),fe(d),ne(()=>{i||(i=ye(t,Rn,{x:400},!0)),i.run(1)}),l=!0)},o(e){ve(n.$$.fragment,e),o&&ve(o.$$.fragment,e),ve(d),i||(i=ye(t,Rn,{x:400},!1)),i.run(0),l=!1},d(r){r&&P(t),$e(n),o&&$e(o),e[10](null),d&&d.d(),r&&i&&i.end()}}}function us(e){let t,n,r;var a=e[5].component;function o(e){return{props:{metadata:e[5].metadata}}}return a&&(n=new a(o(e))),{c(){t=E("div"),n&&ge(n.$$.fragment),D(t,"class","secondary-pane svelte-1dhkl71")},m(e,a){w(e,t,a),n&&be(n,t,null),r=!0},p(e,r){const s={};if(32&r&&(s.metadata=e[5].metadata),a!==(a=e[5].component)){if(n){de();const e=n;ve(e.$$.fragment,1,0,()=>{$e(e,1)}),pe()}a?(n=new a(o(e)),ge(n.$$.fragment),fe(n.$$.fragment,1),be(n,t,null)):n=null}else a&&n.$set(s)},i(e){r||(n&&fe(n.$$.fragment,e),r=!0)},o(e){n&&ve(n.$$.fragment,e),r=!1},d(e){e&&P(t),n&&$e(n)}}}function ds(e){let t,n,r,a,o=e[3]&&cs(e);return{c(){o&&o.c(),t=A()},m(s,i){o&&o.m(s,i),w(s,t,i),n=!0,r||(a=_(window,"keypress",e[9]),r=!0)},p(e,[n]){e[3]?o?(o.p(e,n),8&n&&fe(o,1)):(o=cs(e),o.c(),fe(o,1),o.m(t.parentNode,t)):o&&(de(),ve(o,1,1,()=>{o=null}),pe())},i(e){n||(fe(o),n=!0)},o(e){ve(o),n=!1},d(e){o&&o.d(e),e&&P(t),r=!1,a()}}}function ps(e,t,r){let a,o,s=n,i=()=>(s(),s=u(l,e=>r(11,a=e)),l);e.$$.on_destroy.push(()=>s());let{clientManager:l}=t;i();const c={main:{label:"Main",shortcut:"m",component:Ta},log:{label:"Log",shortcut:"l",component:qo},info:{label:"Info",shortcut:"i",component:Ua},ai:{label:"AI",shortcut:"a",component:ls}},p=Bn(!1),f=Bn(null);let v;d(e,f,e=>r(5,o=e)),F("hotkeys",{disableHotkeys:p}),F("secondaryPane",{secondaryPane:f});let m="main";let y,h=!0;return e.$set=e=>{"clientManager"in e&&i(r(0,l=e.clientManager))},e.$$.update=()=>{2048&e.$$.dirty&&r(4,y=a.client)},[l,v,m,h,y,o,c,f,function(e){r(2,m=e.detail),v.focus()},function(e){"."!=e.key?h&&Object.entries(c).forEach(([t,{shortcut:n}])=>{e.key==n&&r(2,m=t)}):r(3,h=!h)},function(e){X[e?"unshift":"push"](()=>{v=e,r(1,v)})}]}class fs extends Pe{constructor(e){var t;super(),document.getElementById("svelte-1dhkl71-style")||((t=E("style")).id="svelte-1dhkl71-style",t.textContent=".debug-panel.svelte-1dhkl71{position:fixed;color:#555;font-family:monospace;display:flex;flex-direction:row;text-align:left;right:0;top:0;height:100%;font-size:14px;box-sizing:border-box;opacity:0.9;z-index:99999}.pane.svelte-1dhkl71{flex-grow:2;overflow-x:hidden;overflow-y:scroll;background:#fefefe;padding:20px;border-left:1px solid #ccc;box-shadow:-1px 0 5px rgba(0, 0, 0, 0.2);box-sizing:border-box;width:280px}.secondary-pane.svelte-1dhkl71{background:#fefefe;overflow-y:scroll}.debug-panel.svelte-1dhkl71 button,.debug-panel.svelte-1dhkl71 select{cursor:pointer;font-size:14px;font-family:monospace}.debug-panel.svelte-1dhkl71 select{background:#eee;border:1px solid #bbb;color:#555;padding:3px;border-radius:3px}.debug-panel.svelte-1dhkl71 section{margin-bottom:20px}.debug-panel.svelte-1dhkl71 .screen-reader-only{clip:rect(0 0 0 0);clip-path:inset(50%);height:1px;overflow:hidden;position:absolute;white-space:nowrap;width:1px}",x(document.head,t)),we(this,e,ps,ds,c,{clientManager:0})}}const vs=new class{constructor(){this.debugPanel=null,this.currentClient=null,this.clients=new Map,this.subscribers=new Map}register(e){this.clients.set(e,e),this.mountDebug(e),this.notifySubscribers()}unregister(e){if(this.clients.delete(e),this.currentClient===e){this.unmountDebug();for(const[e]of this.clients){if(this.debugPanel)break;this.mountDebug(e)}}this.notifySubscribers()}subscribe(e){const t=Symbol();return this.subscribers.set(t,e),e(this.getState()),()=>{this.subscribers.delete(t)}}switchPlayerID(e){if(this.currentClient.multiplayer)for(const[t]of this.clients)if(t.playerID===e&&!1!==t.debugOpt&&t.multiplayer===this.currentClient.multiplayer)return void this.switchToClient(t);this.currentClient.updatePlayerID(e),this.notifySubscribers()}switchToClient(e){e!==this.currentClient&&(this.unmountDebug(),this.mountDebug(e),this.notifySubscribers())}notifySubscribers(){const e=this.getState();this.subscribers.forEach(t=>{t(e)})}getState(){return{client:this.currentClient,debuggableClients:this.getDebuggableClients()}}getDebuggableClients(){return[...this.clients.values()].filter(e=>!1!==e.debugOpt)}mountDebug(e){if(!1===e.debugOpt||null!==this.debugPanel||"undefined"==typeof document)return;let t,n=document.body;t=fs,e.debugOpt&&!0!==e.debugOpt&&(t=e.debugOpt.impl||t,n=e.debugOpt.target||n),t&&(this.currentClient=e,this.debugPanel=new t({target:n,props:{clientManager:this}}))}unmountDebug(){this.debugPanel.$destroy(),this.debugPanel=null,this.currentClient=null}};function ms(e,t,n){if(!n&&null==e){e=t.getState().ctx.currentPlayer}return e}function ys(e,t,n,r,a,o){return t.reduce((t,s)=>(t[s]=function(...t){n.dispatch(Le[e](s,t,ms(r,n,o),a))},t),{})}const hs=ys.bind(null,"makeMove"),gs=ys.bind(null,"gameEvent"),bs=ys.bind(null,"plugin");class $s{constructor({game:e,debug:n,numPlayers:r,multiplayer:a,matchID:o,playerID:s,credentials:i,enhancer:l}){this.game=hn(e),this.playerID=s,this.matchID=o,this.credentials=i,this.multiplayer=a,this.debugOpt=n,this.manager=vs,this.gameStateOverride=null,this.subscribers={},this._running=!1,this.reducer=Nn({game:this.game,isClient:void 0!==a}),this.initialState=null,a||(this.initialState=Tn({game:this.game,numPlayers:r})),this.reset=()=>{this.store.dispatch(ze(this.initialState))},this.undo=()=>{const e=Ge(ms(this.playerID,this.store,this.multiplayer),this.credentials);this.store.dispatch(e)},this.redo=()=>{const e=qe(ms(this.playerID,this.store,this.multiplayer),this.credentials);this.store.dispatch(e)},this.log=[];const c=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return function(){var n=e.apply(void 0,arguments),r=function(){throw new Error("Dispatching while constructing your middleware is not allowed. Other middleware would not be applied to this dispatch.")},a={getState:n.getState,dispatch:function(){return r.apply(void 0,arguments)}},o=t.map((function(e){return e(a)}));return De({},n,{dispatch:r=Se.apply(void 0,o)(n.dispatch)})}}}(Cn,()=>e=>t=>{const n=e(t);return this.notifySubscribers(),n},e=>t=>n=>{const r=e.getState(),a=t(n);return"clientOnly"in n||this.transport.onAction(r,n),a},e=>t=>n=>{const r=t(n),a=e.getState();switch(n.type){case"MAKE_MOVE":case"GAME_EVENT":case"UNDO":case"REDO":{const e=a.deltalog;this.log=[...this.log,...e];break}case"RESET":this.log=[];break;case"PATCH":case"UPDATE":{let e=-1;this.log.length>0&&(e=this.log[this.log.length-1]._stateID);let t=n.deltalog||[];t=t.filter(t=>t._stateID>e),this.log=[...this.log,...t];break}case"SYNC":this.initialState=n.initialState,this.log=n.log||[]}return r});l=void 0!==l?Se(c,l):c,this.store=je(this.reducer,this.initialState,l),a||(a=Gn),this.transport=a({gameKey:e,game:this.game,store:this.store,matchID:o,playerID:s,credentials:i,gameName:this.game.name,numPlayers:r}),this.createDispatchers(),this.transport.subscribeMatchData(e=>{this.matchData=e,this.notifySubscribers()}),this.chatMessages=[],this.sendChatMessage=e=>{this.transport.onChatMessage(this.matchID,{id:t(7),sender:this.playerID,payload:e})},this.transport.subscribeChatMessage(e=>{this.chatMessages=[...this.chatMessages,e],this.notifySubscribers()})}notifySubscribers(){Object.values(this.subscribers).forEach(e=>e(this.getState()))}overrideGameState(e){this.gameStateOverride=e,this.notifySubscribers()}start(){this.transport.connect(),this._running=!0,this.manager.register(this)}stop(){this.transport.disconnect(),this._running=!1,this.manager.unregister(this)}subscribe(e){const t=Object.keys(this.subscribers).length;return this.subscribers[t]=e,this.transport.subscribe(()=>this.notifySubscribers()),!this._running&&this.multiplayer||e(this.getState()),()=>{delete this.subscribers[t]}}getInitialState(){return this.initialState}getState(){let e=this.store.getState();if(null!==this.gameStateOverride&&(e=this.gameStateOverride),null===e)return e;let t=!0;const n=this.game.flow.isPlayerActive(e.G,e.ctx,this.playerID);return this.multiplayer&&!n&&(t=!1),this.multiplayer||null===this.playerID||void 0===this.playerID||n||(t=!1),void 0!==e.ctx.gameover&&(t=!1),this.multiplayer||(e={...e,G:this.game.playerView(e.G,e.ctx,this.playerID),plugins:sn(e,this)}),{...e,log:this.log,isActive:t,isConnected:this.transport.isConnected}}createDispatchers(){this.moves=hs(this.game.moveNames,this.store,this.playerID,this.credentials,this.multiplayer),this.events=gs(this.game.flow.enabledEventNames,this.store,this.playerID,this.credentials,this.multiplayer),this.plugins=bs(this.game.pluginNames,this.store,this.playerID,this.credentials,this.multiplayer)}updatePlayerID(e){this.playerID=e,this.createDispatchers(),this.transport.updatePlayerID(e),this.notifySubscribers()}updateMatchID(e){this.matchID=e,this.createDispatchers(),this.transport.updateMatchID(e),this.notifySubscribers()}updateCredentials(e){this.credentials=e,this.createDispatchers(),this.transport.updateCredentials(e),this.notifySubscribers()}}const xs=(e,t)=>{if(!e||"string"!=typeof e)throw new Error(`Expected ${t} string, got "${e}".`)},ws=e=>xs(e,"game name"),Ps=e=>xs(e,"match ID"),ks=(e,t)=>{if(!e)throw new Error(`Expected body, got “${e}”.`);for(const n in t){const r=t[n],a=e[n];if(typeof a!==r)throw new TypeError(`Expected body.${n} to be of type ${r}, got “${a}”.`)}};class Es extends Error{constructor(e,t){super(e),this.details=t}}e.Client=function(e){return new $s(e)},e.LobbyClient=class{constructor({server:e=""}={}){this.server=e.replace(/\/$/,"")}async request(e,t){const n=await fetch(this.server+e,t);if(!n.ok){let e;try{e=await n.json()}catch{try{e=await n.text()}catch(t){e=t.message}}throw new Es(`HTTP status ${n.status}`,e)}return n.json()}async post(e,t){let n={method:"post",body:JSON.stringify(t.body),headers:{"Content-Type":"application/json"}};return t.init&&(n={...n,...t.init,headers:{...n.headers,...t.init.headers}}),this.request(e,n)}async listGames(e){return this.request("/games",e)}async listMatches(e,t,n){ws(e);let r="";if(t){const e=[],{isGameover:n,updatedBefore:a,updatedAfter:o}=t;void 0!==n&&e.push(`isGameover=${n}`),a&&e.push(`updatedBefore=${a}`),o&&e.push(`updatedAfter=${o}`),e.length>0&&(r="?"+e.join("&"))}return this.request(`/games/${e}${r}`,n)}async getMatch(e,t,n){return ws(e),Ps(t),this.request(`/games/${e}/${t}`,n)}async createMatch(e,t,n){return ws(e),ks(t,{numPlayers:"number"}),this.post(`/games/${e}/create`,{body:t,init:n})}async joinMatch(e,t,n,r){return ws(e),Ps(t),ks(n,{playerID:"string",playerName:"string"}),this.post(`/games/${e}/${t}/join`,{body:n,init:r})}async leaveMatch(e,t,n,r){ws(e),Ps(t),ks(n,{playerID:"string",credentials:"string"}),await this.post(`/games/${e}/${t}/leave`,{body:n,init:r})}async updatePlayer(e,t,n,r){ws(e),Ps(t),ks(n,{playerID:"string",credentials:"string"}),await this.post(`/games/${e}/${t}/update`,{body:n,init:r})}async playAgain(e,t,n,r){return ws(e),Ps(t),ks(n,{playerID:"string",credentials:"string"}),this.post(`/games/${e}/${t}/playAgain`,{body:n,init:r})}},e.LobbyClientError=Es,Object.defineProperty(e,"__esModule",{value:!0})}));
